classdef CDO_Class < handle
    
    properties
        name='(0,0,4) 100 um thick';
        LatticeConstant=0.356683*10^(-9);
        cluce=299792458;
        hplanck=4.135667516*10^(-15);
        thickness=100*10^-6; %um;
        re=2.8179403227e-15; %m;
        
        %Applied as Rz(Erz).Rx(Erx).Ry(Ery) before rotations at p=0, y=0;
        Erx=0; %An initial rotation of the crystal, at pitch=0, yaw=0 along x axis;
        Ery=0; %An initial rotation of the crystal, at pitch=0, yaw=0 along y axis;
        Erz=0; %An initial rotation of the crystal, at pitch=0, yaw=0 along z axis;
        
        %Flat Crystal Rotation Axis
        PITCH_AXIS=[0,1,0].';
        YAW_AXIS=[0,0,1].';
        ROLL_AXIS=[1,0,0].';
        
        %Beam direction
        BeamPropagation=[0,0,1].';
        
        %Crystal Cut
        MainCut=[0,0,4].'; %The face whose grazing angle to beam direction is pitch angle
        AtPitchYawRollEqual0_MainCutIsOn=[1,0,0].';
        SecondaryCut=[2,2,0].'; % The face normal to beam propagation at p=0, y=0;
        AtPitchYawRollEqual0_SecondaryCutIsOn=[0,0,-1].';
        
        %Axis errors
        %Applied as Rz(PAze).Rx(PAxe).Ry(PAye) to pitch axis
        PAxe=0; %rad
        PAye=0; %rad
        PAze=0; %rad
        
        %Applied as Rz(PAze).Rx(PAxe).Ry(PAye) to pitch axis
        YAxe=0; %rad
        YAye=0; %rad
        YAze=0; %rad

        %Errors in the readout/motor system
        Pitch_Offset=0; %degrees %at 90 degrees
        Yaw_Offset=0; %degrees %at 0 degrees
        Pitch_Scale=1; %uniform scale
        Yaw_Scale=1; %uniform scale
        %Actual Pitch = (PitchMachine-90)*Pitch_Scale+90 + Pitch_Offset;
        %Actual Yaw = YawMachine*Yaw_Scale + Yaw_Offset
        
        PitchRange=[20,160];
        YawRange=[-10,10];
        EnergyRange=[3000,18000];
        
        variables={'name','PitchRange','YawRange','EnergyRange','AtPitchYawRollEqual0_MainCutIsOn','AtPitchYawRollEqual0_SecondaryCutIsOn','LatticeConstant','Erx','Ery','Erz','PITCH_AXIS','YAW_AXIS','BeamPropagation','MainCut','SecondaryCut','PAxe','PAye','PAze','YAxe','YAye','YAze','Pitch_Offset','Yaw_Offset','Pitch_Scale','Yaw_Scale','thickness'};
        
        AllReflections;
        AllReflectionsAbsMax;
        AllReflectionsSqrsum;
        
        M_Zero;
        Costanti;
        Fast_PA;
        Fast_YA;
        
        FCC_structure
        CrMn
        f1f2
        
        atomic_Z
    end
    
    methods
        
        function obj = CDO_Class()
            obj.Evaluate_MZero_and_Constants();
            obj.AssignStructure_and_CrMn();
            obj.Set_f1f2();
            obj.findAllReflections(9,81*3);
        end
        
        function [NewParameters, FinalDistance, InitialDistance, SCAN]=FitObservation(obj,SCAN,Crossweight,Fittingon,RemoveFlagged)
            %variables={'Erx','Ery','Erz','PAxe','PAye','PAze','YAxe','YAye','YAze','Pitch_Offset','Yaw_Offset','Pitch_Scale','Yaw_Scale','thickness'};
            if(nargin<3), Crossweight=1; end
            if(nargin<4), Fittingon={'Pitch_Offset','Yaw_Offset','Erx'}; end
            if(nargin<5), RemoveFlagged=1; end
            CDS=get_crystal(obj);
            if(RemoveFlagged)
               for JJ=numel(SCAN):-1:1
                  for II=numel(SCAN(JJ).Int):-1:1
                      if(~SCAN(JJ).Int(II).FlagA)
                          SCAN(JJ).Int(II)=[];
                      end
                  end
               end
            end
            X0=zeros(size(Fittingon));
            for II=1:numel(Fittingon)
               X0(II)=CDS.(Fittingon{II}); 
            end
            InitialDistance=obj.DistanceFromMeasurement_CDS(CDS,SCAN,Crossweight);
            [NewParameters,FinalDistance]=fminsearch(@(x) obj.DistanceReplacer_CDS(x,CDS,Fittingon,SCAN,Crossweight),X0);    
        end
        
        function Distance=DistanceReplacer_CDS(obj,X,CDS,Fittingon,SCAN,Crossweight)
            for II=1:numel(Fittingon)
               CDS.(Fittingon{II})=X(II); 
            end
            Distance=obj.DistanceFromMeasurement_CDS(CDS,SCAN,Crossweight);
        end
        
        function Distance=DistanceReplacer(obj,X,Fittingon,SCAN,Crossweight)
            for II=1:numel(Fittingon)
               obj.(Fittingon{II})=X(II); 
            end
            Distance=obj.DistanceFromMeasurement(SCAN,Crossweight);
        end
        
        function Distance=DistanceFromMeasurement(obj,SCAN,Crossweight)
            Distance=0;
            for II=1:numel(SCAN)
                   [~,Norm_Der_Pitch,Norm_Der_Yaw]=obj.PhotonEnergy_all_formula(SCAN(II).Norm.Pitch,SCAN(II).Norm.Yaw,SCAN(II).Norm.L.');
                   for JJ=1:numel(SCAN(II).Int)
                       [PHE,Der_Pitch,Der_Yaw]=obj.PhotonEnergy_all_formula(SCAN(II).Int(JJ).Pitch,SCAN(II).Int(JJ).Yaw,[SCAN(II).Int(JJ).L1;SCAN(II).Int(JJ).L2].');
                       if(SCAN(II).Norm.DerivativeDirection) %Pitch scan
                           DerNorm=Der_Pitch/Norm_Der_Pitch;
                       else
                           DerNorm=Der_Yaw/Norm_Der_Yaw;
                       end
                       Distance=Distance + Crossweight*diff(PHE).^2 +  (SCAN(II).Int(JJ).NormDerEnLine1 - DerNorm(1)).^2 + (SCAN(II).Int(JJ).NormDerEnLine2 - DerNorm(2)).^2;
                   end
            end
        end
        
        function Distance=DistanceFromMeasurement_CDS(obj,CDS,SCAN,Crossweight)
            Distance=0;
            for II=1:numel(SCAN)
                   [~,Norm_Der_Pitch,Norm_Der_Yaw]=obj.PhotonEnergy_all_formula_CDS(CDS,SCAN(II).Norm.Pitch,SCAN(II).Norm.Yaw,SCAN(II).Norm.L.');
                   for JJ=1:numel(SCAN(II).Int)
                       [PHE,Der_Pitch,Der_Yaw]=obj.PhotonEnergy_all_formula_CDS(CDS,SCAN(II).Int(JJ).Pitch,SCAN(II).Int(JJ).Yaw,[SCAN(II).Int(JJ).L1;SCAN(II).Int(JJ).L2].');
                       if(SCAN(II).Norm.DerivativeDirection) %Pitch scan
                           DerNorm=Der_Pitch/Norm_Der_Pitch;
                       else
                           DerNorm=Der_Yaw/Norm_Der_Yaw;
                       end
                       Distance=Distance + Crossweight*diff(PHE).^2 +  (SCAN(II).Int(JJ).NormDerEnLine1 - DerNorm(1)).^2 + (SCAN(II).Int(JJ).NormDerEnLine2 - DerNorm(2)).^2;
                   end
            end
        end
        
        function AssignStructure_and_CrMn(obj)
            obj.FCC_structure = [[0, 0, 0]; [0, 0.5, 0.5]; [0.5, 0, 0.5]; [0.5, 0.5, 0];[0.25, 0.25, 0.25]; [0.75, 0.75, 0.25]; [0.25, 0.75, 0.75]; [0.75, 0.25, 0.75]];
            [~,POS]=min(abs(obj.LatticeConstant - [0.356683*10^(-9),5.431020511*10^(-10),5.6575*(10^-10)] ));
            switch(POS)
                case 1
                    obj.CrMn= {[2.310, 1.020, 1.589, 0.865], [20.844, 10.208, 0.569, 51.651], 0.216};
                    obj.atomic_Z=6;
                case 2
                    obj.CrMn={[6.292, 3.035, 1.989, 1.541], [2.439, 32.334, 0.678, 81.694], 1.141};
                    obj.atomic_Z=14;
                case 3
                    obj.CrMn={[6.292, 3.035, 1.989, 1.541], [2.439, 32.334, 0.678, 81.694], 1.141}; % WRONG TO BE UPDATED
                    obj.atomic_Z=32;
                otherwise
                    disp('WARNING: Run in otherwise case in AssignStructure call')
                    obj.CrMn={[6.292, 3.035, 1.989, 1.541], [2.439, 32.334, 0.678, 81.694], 1.141};
            end
            
        end
        
        function out=GammaSymbol(obj,Lambda_in_meter)
            out=Lambda_in_meter.^2*obj.re/pi/obj.LatticeConstant^3;
        end
        
        function out=f0_factor(obj, theta, Lambda_in_meter) %theta and lambda in rows
            Factor=(sin(theta)./(Lambda_in_meter*10^10)).^2;
            out=(obj.CrMn{1}*exp(-obj.CrMn{2}.'*Factor)) +obj.CrMn{3};
        end
        
        function [f1,f1mZ,f2]=Honl_factors(obj,Energy_in_eV)
            f1=interp1(obj.f1f2(:,1),obj.f1f2(:,2),Energy_in_eV);
            f2=interp1(obj.f1f2(:,1),obj.f1f2(:,3),Energy_in_eV);
            f1mZ=f1-obj.atomic_Z;
        end
        
        function out=S_factor(obj,reflections,signum)
                out=sum(exp(signum*2*pi*1i*obj.FCC_structure*reflections),1);
        end
        
        function [F0,FH]=F_factor(obj,reflections,signum,theta,lambda_in_meter)
            f0=obj.f0_factor(theta,lambda_in_meter);
            Energy_in_eV=obj.hplanck*obj.cluce./lambda_in_meter;
            [f1,f1_corr,f2]=obj.Honl_factors(Energy_in_eV);
            S=obj.S_factor(reflections,signum);
            F0=8*(f1+1i*f2);
            FH=(f0+f1_corr+1i*f2).*S;
        end
        
        function [TimeDomain,ReflectionsInfo]=Wake(obj,PitchAngle,YawAngle,Reflections,TimeVector)
            FullRotationMatrix=obj.FullRotation_deg_input(PitchAngle,YawAngle);
            %CounterRotationMatrix=obj.FullRotation_deg_input(-PitchAngle,YawAngle);
            RotatedReflections=FullRotationMatrix*Reflections;
            %CounterRotatedReflections=CounterRotationMatrix*Reflections;
            SurfaceVector=FullRotationMatrix*obj.MainCut;
            Reflectionsnorm=sqrt(sum(Reflections.^2));
            RotatedReflectionNorm=RotatedReflections./Reflectionsnorm;
            %CounterRotatedReflectionsNorm=CounterRotatedReflections./RotatedReflectionNorm;
            SurfaceVectorNorm=SurfaceVector/norm(obj.MainCut);
            Theta=pi/2 - acos((obj.BeamPropagation.'*RotatedReflections/norm(obj.BeamPropagation))./Reflectionsnorm);
            Lambda=abs(2*(obj.LatticeConstant./Reflectionsnorm).*sin(Theta));
            Energies=obj.hplanck*obj.cluce./Lambda;
            K0=2*pi*obj.BeamPropagation./Lambda;
            dd=obj.LatticeConstant./Reflectionsnorm;
            H=2*pi*RotatedReflectionNorm./dd;
            %CounterH=2*pi*CounterRotatedReflectionsNorm./dd;
            
            for II=1:size(Reflections,2)
                NormK0(II)=norm(K0(:,II));
                gamma0(II)=SurfaceVectorNorm.'*K0(:,II)/NormK0(II);
                KHp=K0(:,II)+H(:,II);
                KHm=K0(:,II)-H(:,II);
                %KHcp=K0+CounterH(:,II);
                %KHcm=K0-CounterH(:,II);
                NormKHmp=[norm(KHp),norm(KHm)];%,norm(KHcp),norm(KHcm)];
                [~,POS]=min(abs(NormKHmp-NormK0(II)));
                if(POS==1)
                        KH=KHp;
                else
                        KH=KHm;
                        H(:,II)=-H(:,II);
                end
                gammaH(II)=SurfaceVectorNorm.'*KH/norm(KH);
                b(II)=gamma0(II)/gammaH(II);
                KHall(:,II)=KH;
                NormKH(:,II)=norm(KH);
                ExitDirection(:,II)=KH/norm(KH);
            end

            Bragg=b<=0;
            Laue=b>0;
            
            P=ones(size(Laue));
            [chi0,chiH]=obj.chiConstants(Reflections,Theta,Lambda);
            K0=2*pi./Lambda;
            c=obj.cluce;
            omega=K0*c;
            d=obj.thickness;
            tau_d=2.*d.*sin(Theta).^2./c./abs(gammaH);
            LambdasH=sin(Theta)./(K0.*abs(P).*sqrt(chiH.*conj(chiH))) ;
            tau_0=abs(2*gamma0.*LambdasH.^2/c/d);
            wsH=-chi0./(2*sin(Theta).^2);
            wH=(b-1)./2.*b.*wsH;
            C=exp(1i*chi0.*K0.*d./2./gamma0);
            if(nargin<5)
                for JJ=1:length(tau_d)
                    Points=round(tau_d(JJ)*10^15);
                    xi0=linspace(0,tau_d(JJ),Points);
                    TimeDomain(JJ).Time=xi0;
                    if(Bragg(JJ))
                        Fattorino=C(JJ)./(2*tau_0(JJ)).*exp(-1i*omega(JJ)*wH(JJ).*xi0);
                        BesselPart=(besselj(1,sqrt(xi0./tau_0(JJ).*(1+xi0/tau_d(JJ))))./sqrt(xi0./tau_0(JJ).*(1+xi0/tau_d(JJ))));
                    else
                        Fattorino=C(JJ)./(2*tau_0(JJ)).*(1-xi0./tau_d(JJ)).*exp(-1i*omega(JJ)*wH(JJ).*xi0);
                        BesselPart=(besselj(1,sqrt(xi0./tau_0(JJ).*(1-xi0/tau_d(JJ))))./sqrt(xi0./tau_0(JJ).*(1-xi0/tau_d(JJ))));
                        BesselPart(end)=0.5;
                        BesselPart(1)=0.5;
                    end
                    TimeDomain(JJ).Wake=Fattorino.*BesselPart/10^15;
                end
            else
                for JJ=1:length(tau_d)
                    xi0=TimeVector;
                    TimeDomain(JJ).Time=TimeVector;
                    if(Bragg(JJ))
                        Fattorino=C(JJ)./(2*tau_0(JJ)).*exp(-1i*omega(JJ)*wH(JJ).*xi0);
                        BesselPart=(besselj(1,sqrt(xi0./tau_0(JJ).*(1+xi0/tau_d(JJ))))./sqrt(xi0./tau_0(JJ).*(1+xi0/tau_d(JJ))));  
                    else
                        Fattorino=C(JJ)./(2*tau_0(JJ)).*(1-xi0./tau_d(JJ)).*exp(-1i*omega(JJ)*wH(JJ).*xi0);
                        BesselPart=(besselj(1,sqrt(xi0./tau_0(JJ).*(1-xi0/tau_d(JJ))))./sqrt(xi0./tau_0(JJ).*(1-xi0/tau_d(JJ))));
                        BesselPart(xi0>=tau_d(JJ))=0.5;
                        BesselPart(xi0==0)=0.5;
                    end
                    TimeDomain(JJ).Wake=Fattorino.*BesselPart/10^15;
                end
            end
            PlainRotationMatrix=obj.RotationStages_deg_input(pi/2-PitchAngle,YawAngle);
            InverseRotation = inv(PlainRotationMatrix);
            FullRotationMatrix*obj.BeamPropagation*obj.thickness/2 - FullRotationMatrix*obj.BeamPropagation*(-obj.thickness/2);
            PropagationDirectionEquation=obj.DirectionEquation(obj.BeamPropagation);
            Intersection1=[InverseRotation(1,:);PropagationDirectionEquation]\[obj.thickness/2;0;0];
            Intersection2=[InverseRotation(1,:);PropagationDirectionEquation]\[-obj.thickness/2;0;0];
            EffectiveThickness=norm(Intersection2-Intersection1);
            
            ReflectionsInfo.PlainRotationMatrix=PlainRotationMatrix;
            ReflectionsInfo.FullRotationMatrix=FullRotationMatrix;
            ReflectionsInfo.EffectiveThickness=EffectiveThickness;
            ReflectionsInfo.Theta=Theta;
            ReflectionsInfo.Lambda=Lambda;
            ReflectionsInfo.Energies=Energies;
            %ReflectionsInfo.Eta=Eta;
            ReflectionsInfo.tau_0=tau_0;
            ReflectionsInfo.tau_d=tau_d;
            ReflectionsInfo.Bragg=Bragg;
            ReflectionsInfo.Laue=Laue;
            ReflectionsInfo.b=b;
            
            ReflectionsInfo.RotatedReflections=RotatedReflections;
            ReflectionsInfo.SurfaceVector=SurfaceVector;
            ReflectionsInfo.RotatedReflectionNorm=RotatedReflectionNorm;
            ReflectionsInfo.SurfaceVectorNorm=SurfaceVectorNorm;
            ReflectionsInfo.K0=K0;
            ReflectionsInfo.NormK0=NormK0;
            ReflectionsInfo.gamma0=gamma0;
            ReflectionsInfo.KH=KHall;
            ReflectionsInfo.gammaH=gammaH;
            ReflectionsInfo.ExitDirection=ExitDirection;
            ReflectionsInfo.NormKH=NormKH;
        end
        
         function [chi0,chiH]=chiConstants(obj,Reflections,theta,Lambda_in_meters)
%             chi0test=-0.15121*10^(-4) + 1i*0.13216*10^(-7);
%             chiHtest=0.37816*10^(-5) + 1i*0.12055*10^(-7);
            [~,FHBAR]=obj.F_factor(Reflections,-1,theta,Lambda_in_meters);
            [F0,FH]=obj.F_factor(Reflections,1,theta,Lambda_in_meters);
            
            chi0=obj.GammaSymbol(Lambda_in_meters).*F0;
            chiH=obj.GammaSymbol(Lambda_in_meters).*sqrt((FH.*FHBAR));
        end
        
        function out=DirectionEquation(obj,DIR)
            beam_propagation_0 = find(DIR==0);
            if(isempty(beam_propagation_0)) %all 3 non 0
                out(1,:)=[0,1,-DIR(2)/DIR(3)];
                out(2,:)=[1,-DIR(1)/DIR(2),0];
            else
                if(length(beam_propagation_0)==2)
                    out(1,:) = [0,0,0];
                    out(1,beam_propagation_0(1))=1;
                    out(2,:) = [0,0,0];
                    out(2,beam_propagation_0(2))=1;
                else
                    out(1,:) = [0,0,0];
                    out(1,beam_propagation_0(1))=1;
                    if(beam_propagation_0==1)
                        out(2,:)=[0,1,-DIR(2)/DIR(3)];
                    elseif(beam_propagation_0==2)
                        out(2,:)=[1,0,-DIR(1)/DIR(3)];
                    else
                        out(2,:)=[1,-DIR(1)/DIR(2),0];
                    end
                end
            end
        end
        
        function [PhotonEnergy,PhotonEnergyDer,PhotonEnergyDerYaw]=PhotonEnergy_all_formula(obj,PitchAngle,YawAngle,Reflections)
            PitchAngle=((PitchAngle-90)*obj.Pitch_Scale+90+obj.Pitch_Offset)/180*pi;
            YawAngle=(YawAngle*obj.Yaw_Scale+obj.Yaw_Offset)/180*pi;
            switch(2^isscalar(PitchAngle)*3^isscalar(YawAngle))
                case 1 %Both vectors
                    PhotonEnergyDer=NaN*ones(length(PitchAngle),size(Reflections,2),length(YawAngle));
                    PhotonEnergyDerYaw=PhotonEnergyDer; PhotonEnergy=PhotonEnergyDer;
                    PitchAngle=PitchAngle(:);
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Matrix=zeros(length(PitchAngle),3); Matder=zeros(length(PitchAngle),3); Dermat=zeros(length(PitchAngle),3);
                    for II=1:length(YawAngle)
                    Matrix(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));

                    Matrix(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));

                    Matrix(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));
                    
                    Matder(:,1)=obj.BeamPropagation(1)*(2*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(2)*(2*(1-cos(YawAngle(II))).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(3)*(2*(1-cos(YawAngle(II))).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));
                  
                    Matder(:,2)=obj.BeamPropagation(1)*(2*(1-cos(YawAngle(II))).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(2)*(2*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(3)*(2*(1-cos(YawAngle(II))).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));
       
                    Matder(:,3)=obj.BeamPropagation(1)*(2*(1-cos(YawAngle(II))).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(2)*(2*(1-cos(YawAngle(II))).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(3)*(2*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));
                    
                    Dermat(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle(II))))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle(II)))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II))));
                            
                    Dermat(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle(II)))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle(II))))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II))));
                            
                    Dermat(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle(II))))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II))));
                                   
                    Valois=(((Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);
                    PhotonEnergy(:,:,II)=obj.hplanck*obj.cluce./(abs(2*(obj.LatticeConstant./Reflectionsnorm).*sin(pi/2 - acos(Valois))));
                    PhotonEnergyDer(:,:,II) = (-sign(Valois)./Valois.^2).*(Reflectionsnorm/180*pi*obj.hplanck*obj.cluce/obj.LatticeConstant/2).*((((Matder*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm));
                    PhotonEnergyDerYaw(:,:,II) = (-sign(Valois)./Valois.^2).*(Reflectionsnorm/180*pi*obj.hplanck*obj.cluce/obj.LatticeConstant/2).*((((Dermat*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm));
            
                    end
                    PhotonEnergy=permute(PhotonEnergy,[1,3,2]);
                    PhotonEnergyDer=permute(PhotonEnergyDer,[1,3,2]);
                    PhotonEnergyDerYaw=permute(PhotonEnergyDerYaw,[1,3,2]);
                case 2 %Single Pitch, a vector of YawAngle
                    YawAngle=YawAngle(:);
                    Matrix=zeros(length(YawAngle),3); Matder=zeros(length(YawAngle),3); Dermat=zeros(length(YawAngle),3);

                    Matrix(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));

                    Matrix(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));

                    Matrix(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    
                    Matder(:,1)=obj.BeamPropagation(1)*(2*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                  
                    Matder(:,2)=obj.BeamPropagation(1)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*(2*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
       
                    Matder(:,3)=obj.BeamPropagation(1)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*(2*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    
                    Dermat(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)));
                    
                    Dermat(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)));
                    
                    Dermat(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)));
                            
                            
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Valois=(((Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);
                    
                    PhotonEnergy=obj.hplanck*obj.cluce./(abs(2*(obj.LatticeConstant./Reflectionsnorm).*sin(pi/2 - acos(Valois))));
                    PhotonEnergyDer = (-sign(Valois)./Valois.^2).*(Reflectionsnorm/180*pi*obj.hplanck*obj.cluce/obj.LatticeConstant/2).*((((Matder*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm));
                    PhotonEnergyDerYaw = (-sign(Valois)./Valois.^2).*(Reflectionsnorm/180*pi*obj.hplanck*obj.cluce/obj.LatticeConstant/2).*((((Dermat*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm));

                case 3 %Single Yaw, a vector of PitchAngle
                    PitchAngle=PitchAngle(:);
                    Matrix=zeros(length(PitchAngle),3); Matder=zeros(length(PitchAngle),3); Dermat=zeros(length(PitchAngle),3);

                    Matrix(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));

                    Matrix(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));

                    Matrix(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    
                    Matder(:,1)=obj.BeamPropagation(1)*(2*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                  
                    Matder(:,2)=obj.BeamPropagation(1)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*(2*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
       
                    Matder(:,3)=obj.BeamPropagation(1)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*(2*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    
                    Dermat(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)));
                    
                    Dermat(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)));
                    
                    Dermat(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)));
                            
                            
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Valois=(((Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);
                    
                    PhotonEnergy=obj.hplanck*obj.cluce./(abs(2*(obj.LatticeConstant./Reflectionsnorm).*sin(pi/2 - acos(Valois))));
                    PhotonEnergyDer = (-sign(Valois)./Valois.^2).*(Reflectionsnorm/180*pi*obj.hplanck*obj.cluce/obj.LatticeConstant/2).*((((Matder*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm));
                    PhotonEnergyDerYaw = (-sign(Valois)./Valois.^2).*(Reflectionsnorm/180*pi*obj.hplanck*obj.cluce/obj.LatticeConstant/2).*((((Dermat*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm));
     
                case 6 %Both singles.
                    
                    Rot_Matrix=zeros(3);
                    Rot_Matrix(1,1)=(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(1,2)=(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(1,3)=(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(2,1)=(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(2,2)=(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(2,3)=(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(3,1)=(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(3,2)=(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(3,3)=(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));

                    Der_Matrix=zeros(3);
                    Der_Matrix(1,1)=2*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(1,2)=2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(1,3)=2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(2,1)=2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(2,2)=2*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(2,3)=2*(1-cos(YawAngle)).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(3,1)=2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(3,2)=2*(1-cos(YawAngle)).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(3,3)=2*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    
                    yDer_Matrix=zeros(3);
                    yDer_Matrix(1,1)=(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle));
                    yDer_Matrix(1,2)=(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle));
                    yDer_Matrix(1,3)=(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle));
                    yDer_Matrix(2,1)=(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle));
                    yDer_Matrix(2,2)=(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle));
                    yDer_Matrix(2,3)=(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle));
                    yDer_Matrix(3,1)=(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle));
                    yDer_Matrix(3,2)=(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle));
                    yDer_Matrix(3,3)=(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle));
            
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Valois=(((obj.BeamPropagation.'*Rot_Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);     
                    PhotonEnergy=obj.hplanck*obj.cluce./(abs(2*(obj.LatticeConstant./Reflectionsnorm).*sin(pi/2 - acos(Valois))));
                    PhotonEnergyDer = -(sign(Valois)./Valois.^2).*Reflectionsnorm/180*pi.*obj.hplanck.*obj.cluce./obj.LatticeConstant./2.*(((obj.BeamPropagation.'*Der_Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);
                    PhotonEnergyDerYaw = -(sign(Valois)./Valois.^2).*Reflectionsnorm/180*pi.*obj.hplanck.*obj.cluce./obj.LatticeConstant./2.*(((obj.BeamPropagation.'*yDer_Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);
            end
        end
        
        function PhotonEnergy=PhotonEnergy_fast_formula(obj,PitchAngle,YawAngle,Reflections)
            PitchAngle=((PitchAngle-90)*obj.Pitch_Scale+90+obj.Pitch_Offset)/180*pi;
            YawAngle=(YawAngle*obj.Yaw_Scale+obj.Yaw_Offset)/180*pi;
            switch(2^isscalar(PitchAngle)*3^isscalar(YawAngle))
                case 1 %Both vectors
                    PhotonEnergy=NaN*ones(length(PitchAngle),size(Reflections,2),length(YawAngle));
                    PitchAngle=PitchAngle(:);
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Matrix=zeros(length(PitchAngle),3);
                    for II=1:length(YawAngle)
                        Matrix(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                            obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                            obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));
                        
                        Matrix(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                            obj.BeamPropagation(2)*((obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                            obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));
                        
                        Matrix(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                            obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                            obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));
                        
                        Lambda=abs(2*(obj.LatticeConstant./Reflectionsnorm).*sin(pi/2 - acos(((Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm)));
                        PhotonEnergy(:,:,II)=obj.hplanck*obj.cluce./Lambda;
                    end
                    PhotonEnergy=permute(PhotonEnergy,[1,3,2]);
                case 2 %Single Pitch, a vector of YawAngle
                    YawAngle=YawAngle(:);
                    Matrix=zeros(length(YawAngle),3);
                    Matrix(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));

                    Matrix(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));

                    Matrix(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Lambda=abs(2*(obj.LatticeConstant./Reflectionsnorm).*sin(pi/2 - acos(((Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm)));       
                    PhotonEnergy=obj.hplanck*obj.cluce./Lambda;
                case 3 %Single Yaw, a vector of PitchAngle
                    PitchAngle=PitchAngle(:);
                    Matrix=zeros(length(PitchAngle),3);
                    Matrix(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));

                    Matrix(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));

                    Matrix(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Lambda=abs(2*(obj.LatticeConstant./Reflectionsnorm).*sin(pi/2 - acos(((Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm)));       
                    PhotonEnergy=obj.hplanck*obj.cluce./Lambda;
                case 6 %Both singles.
                    Rot_Matrix=zeros(3);
                    Rot_Matrix(1,1)=(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(1,2)=(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(1,3)=(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(2,1)=(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(2,2)=(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(2,3)=(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(3,1)=(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(3,2)=(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(3,3)=(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Lambda=abs(2*(obj.LatticeConstant./Reflectionsnorm).*sin(pi/2 - acos(((obj.BeamPropagation.'*Rot_Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm))); 
                    PhotonEnergy=obj.hplanck*obj.cluce./Lambda;
            end
        end
        
        function PhotonEnergyDer=PhotonEnergy_fast_formula_derPitch(obj,PitchAngle,YawAngle,Reflections)
            PitchAngle=((PitchAngle-90)*obj.Pitch_Scale+90+obj.Pitch_Offset)/180*pi;
            YawAngle=(YawAngle*obj.Yaw_Scale+obj.Yaw_Offset)/180*pi;
            switch(2^isscalar(PitchAngle)*3^isscalar(YawAngle))
                case 1 %Both vectors
                    PhotonEnergyDer=NaN*ones(length(PitchAngle),size(Reflections,2),length(YawAngle));
                    PitchAngle=PitchAngle(:);
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Matrix=zeros(length(PitchAngle),3); Matder=zeros(length(PitchAngle),3);
                    for II=1:length(YawAngle)
                    Matrix(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));

                    Matrix(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));

                    Matrix(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));
                    
                    Matder(:,1)=obj.BeamPropagation(1)*(2*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(2)*(2*(1-cos(YawAngle(II))).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(3)*(2*(1-cos(YawAngle(II))).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));
                  
                    Matder(:,2)=obj.BeamPropagation(1)*(2*(1-cos(YawAngle(II))).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(2)*(2*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(3)*(2*(1-cos(YawAngle(II))).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));
       
                    Matder(:,3)=obj.BeamPropagation(1)*(2*(1-cos(YawAngle(II))).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(2)*(2*(1-cos(YawAngle(II))).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                                obj.BeamPropagation(3)*(2*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));
                        
                    Valois=(((Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);
                    PhotonEnergyDer(:,:,II) = (-sign(Valois)./Valois.^2).*(Reflectionsnorm/180*pi*obj.hplanck*obj.cluce/obj.LatticeConstant/2).*((((Matder*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm));

                    end
                    PhotonEnergyDer=permute(PhotonEnergyDer,[1,3,2]);
                case 2 %Single Pitch, a vector of YawAngle
                    YawAngle=YawAngle(:);
                    Matrix=zeros(length(YawAngle),3); Matder=zeros(length(YawAngle),3);

                    Matrix(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));

                    Matrix(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));

                    Matrix(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    
                    Matder(:,1)=obj.BeamPropagation(1)*(2*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                  
                    Matder(:,2)=obj.BeamPropagation(1)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*(2*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
       
                    Matder(:,3)=obj.BeamPropagation(1)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*(2*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Valois=(((Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);
                    PhotonEnergyDer = (-sign(Valois)./Valois.^2).*(Reflectionsnorm/180*pi*obj.hplanck*obj.cluce/obj.LatticeConstant/2).*((((Matder*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm));

                case 3 %Single Yaw, a vector of PitchAngle
                    PitchAngle=PitchAngle(:);
                    Matrix=zeros(length(PitchAngle),3); Matder=zeros(length(PitchAngle),3);

                    Matrix(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));

                    Matrix(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));

                    Matrix(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    
                    Matder(:,1)=obj.BeamPropagation(1)*(2*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                  
                    Matder(:,2)=obj.BeamPropagation(1)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*(2*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
       
                    Matder(:,3)=obj.BeamPropagation(1)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(2)*(2*(1-cos(YawAngle)).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                                obj.BeamPropagation(3)*(2*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Valois=(((Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);
                    PhotonEnergyDer = (-sign(Valois)./Valois.^2).*(Reflectionsnorm/180*pi*obj.hplanck*obj.cluce/obj.LatticeConstant/2).*((((Matder*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm));
                    
                case 6 %Both singles.
                    
                    Rot_Matrix=zeros(3);
                    Rot_Matrix(1,1)=(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(1,2)=(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(1,3)=(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(2,1)=(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(2,2)=(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(2,3)=(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(3,1)=(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(3,2)=(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(3,3)=(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));

                    Der_Matrix=zeros(3);
                    Der_Matrix(1,1)=2*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(1,2)=2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(1,3)=2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_YA(3).*sin(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(2,1)=2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(2,2)=2*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(2,3)=2*(1-cos(YawAngle)).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_YA(3).*sin(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(3,1)=2*(1-cos(YawAngle)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(3,2)=2*(1-cos(YawAngle)).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Der_Matrix(3,3)=2*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(-sin(PitchAngle)+obj.Fast_PA(2).^2.*sin(PitchAngle))+obj.Fast_YA(3).*(-obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-sin(PitchAngle)+obj.Fast_PA(1).^2.*sin(PitchAngle))+obj.Fast_YA(2).*(-obj.Fast_PA(3).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle)))+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(1).*(-obj.Fast_PA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*sin(PitchAngle))+obj.Fast_YA(3).*(-sin(PitchAngle)+obj.Fast_PA(3).^2.*sin(PitchAngle)))+(-obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Valois=(((obj.BeamPropagation.'*Rot_Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);
                    PhotonEnergyDer = (-sign(Valois)./Valois.^2.*Reflectionsnorm/180*pi*obj.hplanck*obj.cluce/obj.LatticeConstant/2).*(((obj.BeamPropagation.'*Der_Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);
            end
        end
        
        function PhotonEnergyDer=PhotonEnergy_fast_formula_derYaw(obj,PitchAngle,YawAngle,Reflections)
            PitchAngle=((PitchAngle-90)*obj.Pitch_Scale+90+obj.Pitch_Offset)/180*pi;
            YawAngle=(YawAngle*obj.Yaw_Scale+obj.Yaw_Offset)/180*pi;
            switch(2^isscalar(PitchAngle)*3^isscalar(YawAngle))
                case 1 %Both vectors
                    PhotonEnergyDer=NaN*ones(length(PitchAngle),size(Reflections,2),length(YawAngle));
                    PitchAngle=PitchAngle(:);
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Matrix=zeros(length(PitchAngle),3); Dermat=zeros(length(PitchAngle),3);
                    for II=1:length(YawAngle)
                        Matrix(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                            obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                            obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));
                        
                        Matrix(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                            obj.BeamPropagation(2)*((obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                            obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));
                        
                        Matrix(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                            obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))))+...
                            obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II))+(1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle(II))).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle(II))));
                        
                        Dermat(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II))))+...
                            obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle(II))))+...
                            obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle(II)))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II))));
                        
                        Dermat(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle(II)))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II))))+...
                            obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle(II))))+...
                            obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II))));
                        
                        Dermat(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II))))+...
                            obj.BeamPropagation(2)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle(II))))+...
                            obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle(II))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle(II)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle(II)).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II)))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle(II)).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle(II))));
                        
                        Valois=(((Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);
                        PhotonEnergyDer(:,:,II) = (-sign(Valois)./Valois.^2).*(Reflectionsnorm/180*pi*obj.hplanck*obj.cluce/obj.LatticeConstant/2).*((((Dermat*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm));
                    end
                    PhotonEnergyDer=permute(PhotonEnergyDer,[1,3,2]);
                case 2 %Single Pitch, a vector of YawAngle
                    YawAngle=YawAngle(:);
                    Matrix=zeros(length(YawAngle),3); Dermat=zeros(length(YawAngle),3);
                    
                    Matrix(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    
                    Matrix(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    
                    Matrix(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    
                    
                    Dermat(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)));
                    
                    Dermat(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)));
                    
                    Dermat(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)));
                    
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Valois=(((Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);
                    PhotonEnergyDer = (-sign(Valois)./Valois.^2).*(Reflectionsnorm/180*pi*obj.hplanck*obj.cluce/obj.LatticeConstant/2).*((((Dermat*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm));
                    
                    
                case 3 %Single Yaw, a vector of PitchAngle
                    PitchAngle=PitchAngle(:);
                    Matrix=zeros(length(PitchAngle),3); Dermat=zeros(length(PitchAngle),3);
                    
                    Matrix(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    
                    Matrix(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    
                    Matrix(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle)));
                    
                    Dermat(:,1)=obj.BeamPropagation(1)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)));
                    
                    Dermat(:,2)=obj.BeamPropagation(1)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)));
                    
                    Dermat(:,3)=obj.BeamPropagation(1)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)))+...
                        obj.BeamPropagation(2)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle)))+...
                        obj.BeamPropagation(3)*((obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle)));
                    
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Valois=(((Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);
                    PhotonEnergyDer = (-sign(Valois)./Valois.^2).*(Reflectionsnorm/180*pi*obj.hplanck*obj.cluce/obj.LatticeConstant/2).*((((Dermat*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm));
                    
                case 6 %Both singles.
                    
                    Rot_Matrix=zeros(3);
                    Rot_Matrix(1,1)=(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(1,2)=(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(1,3)=(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(2,1)=(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(2,2)=(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(2,3)=(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(3,1)=(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(3,2)=(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    Rot_Matrix(3,3)=(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle)+(1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2)+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)))+(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*((1-cos(YawAngle)).*(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)))+(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle)).*sin(YawAngle));
                    
                    Der_Matrix=zeros(3);
                    Der_Matrix(1,1)=(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle));
                    Der_Matrix(1,2)=(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle));
                    Der_Matrix(1,3)=(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)+obj.Fast_PA(2).^2.*obj.Fast_YA(2)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)-obj.Fast_PA(3).^2.*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)-obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle));
                    Der_Matrix(2,1)=(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle));
                    Der_Matrix(2,2)=(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle));
                    Der_Matrix(2,3)=(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).^2.*obj.Fast_YA(1)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)-obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)+obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2)+obj.Fast_PA(3).^2.*obj.Fast_YA(3)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).^2.*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(2).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(2).*sin(PitchAngle))+(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).^2.*sin(YawAngle));
                    Der_Matrix(3,1)=(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle));
                    Der_Matrix(3,2)=(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle));
                    Der_Matrix(3,3)=(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle)).*(-sin(YawAngle)+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).^2.*sin(YawAngle))+(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle)).*(cos(YawAngle).*(-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1)-obj.Fast_PA(2).^2.*obj.Fast_YA(2)-obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).^2.*obj.Fast_YA(2).*cos(PitchAngle)+obj.Fast_PA(2).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(1).*sin(PitchAngle)+obj.Fast_PA(1).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(1).*(obj.Fast_PA(1).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(2).*sin(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))-obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle))+(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle)).*(cos(YawAngle).*(obj.Fast_PA(1).^2.*obj.Fast_YA(1)+obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2)+obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3)+obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).^2.*obj.Fast_YA(1).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(2).*obj.Fast_YA(2).*cos(PitchAngle)-obj.Fast_PA(1).*obj.Fast_PA(3).*obj.Fast_YA(3).*cos(PitchAngle)-obj.Fast_PA(3).*obj.Fast_YA(2).*sin(PitchAngle)+obj.Fast_PA(2).*obj.Fast_YA(3).*sin(PitchAngle))+(obj.Fast_YA(3).*(obj.Fast_PA(3).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(2).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))+obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(2).*sin(PitchAngle))).*(obj.Fast_YA(2).*(obj.Fast_PA(2).^2.*(1-cos(PitchAngle))+cos(PitchAngle))+obj.Fast_YA(3).*(obj.Fast_PA(2).*obj.Fast_PA(3).*(1-cos(PitchAngle))-obj.Fast_PA(1).*sin(PitchAngle))+obj.Fast_YA(1).*(obj.Fast_PA(1).*obj.Fast_PA(2).*(1-cos(PitchAngle))+obj.Fast_PA(3).*sin(PitchAngle))).*sin(YawAngle));
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Valois=(((obj.BeamPropagation.'*Rot_Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);
                    PhotonEnergyDer = (-sign(Valois)./Valois.^2.*Reflectionsnorm/180*pi*obj.hplanck*obj.cluce/obj.LatticeConstant/2).*(((obj.BeamPropagation.'*Der_Matrix*obj.M_Zero*Reflections)/norm(obj.BeamPropagation))./Reflectionsnorm);
            end
        end
        
        function obj = MathematicaTestValues(obj)
            obj.PAxe=0.1; %rad
            obj.PAye=0.2; %rad
            obj.PAze=0.3; %rad
            
            %Applied as Rz(PAze).Rx(PAxe).Ry(PAye) to pitch axis
            obj.YAxe=-0.1; %rad
            obj.YAye=-0.2; %rad
            obj.YAze=-0.3; %rad
            
            obj.PAxe=0.1; %rad
            obj.PAye=-0.125; %rad
            obj.PAze=0.15; %rad
            
            %Applied as Rz(PAze).Rx(PAxe).Ry(PAye) to pitch axis
            obj.YAxe=0.2; %rad
            obj.YAye=-0.1; %rad
            obj.YAze=0.05; %rad
            
            obj.Erx=-0.15;
            obj.Ery=0.12;
            obj.Erz=0.05;
            obj.Evaluate_MZero_and_Constants();
        end
 
        function Evaluate_MZero_and_Constants(obj)
            obj.M_Zero=obj.CrystalInHolder()*obj.InitialRotation();
            obj.Costanti=obj.cluce*obj.hplanck/(2*obj.LatticeConstant);
            obj.Fast_PA=obj.PitchAxis();
            obj.Fast_YA=obj.YawAxis(0);
        end
        
        function [PHE,Lambda] = PhotonEnergy(obj,PitchAngle,YawAngle,Reflections)
            RotatedReflections=obj.FullRotation_deg_input(PitchAngle,YawAngle)*Reflections;
            Reflectionsnorm=sqrt(sum(Reflections.^2));
            Lambda=abs(2*(obj.LatticeConstant./Reflectionsnorm).*sin(pi/2 - acos((obj.BeamPropagation.'*RotatedReflections/norm(obj.BeamPropagation))./Reflectionsnorm)));
            PHE=obj.hplanck*obj.cluce./Lambda; 
        end
        
        function [PHE_Der_pitch,PHE_Der_yaw] = PhotonEnergy_Der(obj,PitchAngle,YawAngle,Reflections,Step)
            [PHE_pp,~] = obj.PhotonEnergy(PitchAngle+Step/2,YawAngle,Reflections);
            [PHE_pm,~] = obj.PhotonEnergy(PitchAngle-Step/2,YawAngle,Reflections);
            [PHE_yp,~] = obj.PhotonEnergy(PitchAngle,YawAngle+Step/2,Reflections);
            [PHE_ym,~] = obj.PhotonEnergy(PitchAngle,YawAngle-Step/2,Reflections);
            PHE_Der_pitch=(PHE_pp-PHE_pm)/Step;
            PHE_Der_yaw=(PHE_yp-PHE_ym)/Step;
        end
        
        function [PhotonEnergy,PhotonEnergyDer,PhotonEnergyDerYaw]=PhotonEnergy_all_formula_CDS(obj,CDS,Pitch,Yaw,Reflections)
            Pitch=((Pitch-90)*CDS.Pitch_Scale+90+CDS.Pitch_Offset)/180*pi;
            Yaw=(Yaw*CDS.Yaw_Scale+CDS.Yaw_Offset)/180*pi;
            FPA=obj.Rz(CDS.PAze)*obj.Rx(CDS.PAxe)*obj.Ry(CDS.PAye)*CDS.PITCH_AXIS;
            FYA=obj.Arb_Rot(0,obj.Rz(CDS.PAze)*obj.Rx(CDS.PAxe)*obj.Ry(CDS.PAye)*CDS.PITCH_AXIS)*(obj.Rz(CDS.YAze)*obj.Rx(CDS.YAxe)*obj.Ry(CDS.YAye)*CDS.YAW_AXIS);
            MZero=(obj.Rz(CDS.Erz)*obj.Rx(CDS.Erx)*obj.Ry(CDS.Ery))*obj.InitialRotation();
            
            
                    Rot_Matrix=zeros(3);
                    Rot_Matrix(1,1)=(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).^2)+(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(-FPA(1).*FPA(3).*FYA(1)-FPA(2).*FPA(3).*FYA(2)-FPA(3).^2.*FYA(3)+FPA(1).*FPA(3).*FYA(1).*cos(Pitch)+FPA(2).*FPA(3).*FYA(2).*cos(Pitch)-FYA(3).*cos(Pitch)+FPA(3).^2.*FYA(3).*cos(Pitch)+FPA(2).*FYA(1).*sin(Pitch)-FPA(1).*FYA(2).*sin(Pitch)).*sin(Yaw))+(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)))+(FPA(1).*FPA(2).*FYA(1)+FPA(2).^2.*FYA(2)+FPA(2).*FPA(3).*FYA(3)-FPA(1).*FPA(2).*FYA(1).*cos(Pitch)+FYA(2).*cos(Pitch)-FPA(2).^2.*FYA(2).*cos(Pitch)-FPA(2).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(1).*sin(Pitch)-FPA(1).*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Rot_Matrix(1,2)=(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).^2)+(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch)).*((1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(-FPA(1).*FPA(3).*FYA(1)-FPA(2).*FPA(3).*FYA(2)-FPA(3).^2.*FYA(3)+FPA(1).*FPA(3).*FYA(1).*cos(Pitch)+FPA(2).*FPA(3).*FYA(2).*cos(Pitch)-FYA(3).*cos(Pitch)+FPA(3).^2.*FYA(3).*cos(Pitch)+FPA(2).*FYA(1).*sin(Pitch)-FPA(1).*FYA(2).*sin(Pitch)).*sin(Yaw))+(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)))+(FPA(1).*FPA(2).*FYA(1)+FPA(2).^2.*FYA(2)+FPA(2).*FPA(3).*FYA(3)-FPA(1).*FPA(2).*FYA(1).*cos(Pitch)+FYA(2).*cos(Pitch)-FPA(2).^2.*FYA(2).*cos(Pitch)-FPA(2).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(1).*sin(Pitch)-FPA(1).*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Rot_Matrix(1,3)=(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).^2)+(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(-FPA(1).*FPA(3).*FYA(1)-FPA(2).*FPA(3).*FYA(2)-FPA(3).^2.*FYA(3)+FPA(1).*FPA(3).*FYA(1).*cos(Pitch)+FPA(2).*FPA(3).*FYA(2).*cos(Pitch)-FYA(3).*cos(Pitch)+FPA(3).^2.*FYA(3).*cos(Pitch)+FPA(2).*FYA(1).*sin(Pitch)-FPA(1).*FYA(2).*sin(Pitch)).*sin(Yaw))+(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)))+(FPA(1).*FPA(2).*FYA(1)+FPA(2).^2.*FYA(2)+FPA(2).*FPA(3).*FYA(3)-FPA(1).*FPA(2).*FYA(1).*cos(Pitch)+FYA(2).*cos(Pitch)-FPA(2).^2.*FYA(2).*cos(Pitch)-FPA(2).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(1).*sin(Pitch)-FPA(1).*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Rot_Matrix(2,1)=(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).^2)+(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch)).*((1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(FPA(1).*FPA(3).*FYA(1)+FPA(2).*FPA(3).*FYA(2)+FPA(3).^2.*FYA(3)-FPA(1).*FPA(3).*FYA(1).*cos(Pitch)-FPA(2).*FPA(3).*FYA(2).*cos(Pitch)+FYA(3).*cos(Pitch)-FPA(3).^2.*FYA(3).*cos(Pitch)-FPA(2).*FYA(1).*sin(Pitch)+FPA(1).*FYA(2).*sin(Pitch)).*sin(Yaw))+(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(-FPA(1).^2.*FYA(1)-FPA(1).*FPA(2).*FYA(2)-FPA(1).*FPA(3).*FYA(3)-FYA(1).*cos(Pitch)+FPA(1).^2.*FYA(1).*cos(Pitch)+FPA(1).*FPA(2).*FYA(2).*cos(Pitch)+FPA(1).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(2).*sin(Pitch)-FPA(2).*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Rot_Matrix(2,2)=(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).^2)+(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(FPA(1).*FPA(3).*FYA(1)+FPA(2).*FPA(3).*FYA(2)+FPA(3).^2.*FYA(3)-FPA(1).*FPA(3).*FYA(1).*cos(Pitch)-FPA(2).*FPA(3).*FYA(2).*cos(Pitch)+FYA(3).*cos(Pitch)-FPA(3).^2.*FYA(3).*cos(Pitch)-FPA(2).*FYA(1).*sin(Pitch)+FPA(1).*FYA(2).*sin(Pitch)).*sin(Yaw))+(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(-FPA(1).^2.*FYA(1)-FPA(1).*FPA(2).*FYA(2)-FPA(1).*FPA(3).*FYA(3)-FYA(1).*cos(Pitch)+FPA(1).^2.*FYA(1).*cos(Pitch)+FPA(1).*FPA(2).*FYA(2).*cos(Pitch)+FPA(1).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(2).*sin(Pitch)-FPA(2).*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Rot_Matrix(2,3)=(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).^2)+(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(FPA(1).*FPA(3).*FYA(1)+FPA(2).*FPA(3).*FYA(2)+FPA(3).^2.*FYA(3)-FPA(1).*FPA(3).*FYA(1).*cos(Pitch)-FPA(2).*FPA(3).*FYA(2).*cos(Pitch)+FYA(3).*cos(Pitch)-FPA(3).^2.*FYA(3).*cos(Pitch)-FPA(2).*FYA(1).*sin(Pitch)+FPA(1).*FYA(2).*sin(Pitch)).*sin(Yaw))+(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(-FPA(1).^2.*FYA(1)-FPA(1).*FPA(2).*FYA(2)-FPA(1).*FPA(3).*FYA(3)-FYA(1).*cos(Pitch)+FPA(1).^2.*FYA(1).*cos(Pitch)+FPA(1).*FPA(2).*FYA(2).*cos(Pitch)+FPA(1).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(2).*sin(Pitch)-FPA(2).*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Rot_Matrix(3,1)=(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).^2)+(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)))+(-FPA(1).*FPA(2).*FYA(1)-FPA(2).^2.*FYA(2)-FPA(2).*FPA(3).*FYA(3)+FPA(1).*FPA(2).*FYA(1).*cos(Pitch)-FYA(2).*cos(Pitch)+FPA(2).^2.*FYA(2).*cos(Pitch)+FPA(2).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(1).*sin(Pitch)+FPA(1).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(FPA(1).^2.*FYA(1)+FPA(1).*FPA(2).*FYA(2)+FPA(1).*FPA(3).*FYA(3)+FYA(1).*cos(Pitch)-FPA(1).^2.*FYA(1).*cos(Pitch)-FPA(1).*FPA(2).*FYA(2).*cos(Pitch)-FPA(1).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(2).*sin(Pitch)+FPA(2).*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Rot_Matrix(3,2)=(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).^2)+(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)))+(-FPA(1).*FPA(2).*FYA(1)-FPA(2).^2.*FYA(2)-FPA(2).*FPA(3).*FYA(3)+FPA(1).*FPA(2).*FYA(1).*cos(Pitch)-FYA(2).*cos(Pitch)+FPA(2).^2.*FYA(2).*cos(Pitch)+FPA(2).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(1).*sin(Pitch)+FPA(1).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(FPA(1).^2.*FYA(1)+FPA(1).*FPA(2).*FYA(2)+FPA(1).*FPA(3).*FYA(3)+FYA(1).*cos(Pitch)-FPA(1).^2.*FYA(1).*cos(Pitch)-FPA(1).*FPA(2).*FYA(2).*cos(Pitch)-FPA(1).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(2).*sin(Pitch)+FPA(2).*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Rot_Matrix(3,3)=(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).^2)+(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)))+(-FPA(1).*FPA(2).*FYA(1)-FPA(2).^2.*FYA(2)-FPA(2).*FPA(3).*FYA(3)+FPA(1).*FPA(2).*FYA(1).*cos(Pitch)-FYA(2).*cos(Pitch)+FPA(2).^2.*FYA(2).*cos(Pitch)+FPA(2).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(1).*sin(Pitch)+FPA(1).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(FPA(1).^2.*FYA(1)+FPA(1).*FPA(2).*FYA(2)+FPA(1).*FPA(3).*FYA(3)+FYA(1).*cos(Pitch)-FPA(1).^2.*FYA(1).*cos(Pitch)-FPA(1).*FPA(2).*FYA(2).*cos(Pitch)-FPA(1).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(2).*sin(Pitch)+FPA(2).*FYA(3).*sin(Pitch)).*sin(Yaw));

                    Der_Matrix=zeros(3);
                    Der_Matrix(1,1)=2*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch)).*(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(1).*(-sin(Pitch)+FPA(1).^2.*sin(Pitch))+FYA(2).*(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(3).*(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)))+(-sin(Pitch)+FPA(1).^2.*sin(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).^2)+(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(-FPA(1).*FPA(3).*FYA(1)-FPA(2).*FPA(3).*FYA(2)-FPA(3).^2.*FYA(3)+FPA(1).*FPA(3).*FYA(1).*cos(Pitch)+FPA(2).*FPA(3).*FYA(2).*cos(Pitch)-FYA(3).*cos(Pitch)+FPA(3).^2.*FYA(3).*cos(Pitch)+FPA(2).*FYA(1).*sin(Pitch)-FPA(1).*FYA(2).*sin(Pitch)).*sin(Yaw))+(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)))+(FPA(1).*FPA(2).*FYA(1)+FPA(2).^2.*FYA(2)+FPA(2).*FPA(3).*FYA(3)-FPA(1).*FPA(2).*FYA(1).*cos(Pitch)+FYA(2).*cos(Pitch)-FPA(2).^2.*FYA(2).*cos(Pitch)-FPA(2).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(1).*sin(Pitch)-FPA(1).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(-sin(Pitch)+FPA(1).^2.*sin(Pitch))+FYA(2).*(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(3).*(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(1).*(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch))+FYA(2).*(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch))+FYA(3).*(-sin(Pitch)+FPA(3).^2.*sin(Pitch)))+(FPA(3).*FYA(1).*cos(Pitch)-FPA(1).*FYA(3).*cos(Pitch)+FPA(1).*FPA(2).*FYA(1).*sin(Pitch)-FYA(2).*sin(Pitch)+FPA(2).^2.*FYA(2).*sin(Pitch)+FPA(2).*FPA(3).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*(FYA(1).*(-sin(Pitch)+FPA(1).^2.*sin(Pitch))+FYA(2).*(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(3).*(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(1).*(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(2).*(-sin(Pitch)+FPA(2).^2.*sin(Pitch))+FYA(3).*(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)))+(FPA(2).*FYA(1).*cos(Pitch)-FPA(1).*FYA(2).*cos(Pitch)-FPA(1).*FPA(3).*FYA(1).*sin(Pitch)-FPA(2).*FPA(3).*FYA(2).*sin(Pitch)+FYA(3).*sin(Pitch)-FPA(3).^2.*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Der_Matrix(1,2)=2*(1-cos(Yaw)).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(1).*(-sin(Pitch)+FPA(1).^2.*sin(Pitch))+FYA(2).*(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(3).*(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)))+(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).^2)+(-sin(Pitch)+FPA(2).^2.*sin(Pitch)).*((1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(-FPA(1).*FPA(3).*FYA(1)-FPA(2).*FPA(3).*FYA(2)-FPA(3).^2.*FYA(3)+FPA(1).*FPA(3).*FYA(1).*cos(Pitch)+FPA(2).*FPA(3).*FYA(2).*cos(Pitch)-FYA(3).*cos(Pitch)+FPA(3).^2.*FYA(3).*cos(Pitch)+FPA(2).*FYA(1).*sin(Pitch)-FPA(1).*FYA(2).*sin(Pitch)).*sin(Yaw))+(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)))+(FPA(1).*FPA(2).*FYA(1)+FPA(2).^2.*FYA(2)+FPA(2).*FPA(3).*FYA(3)-FPA(1).*FPA(2).*FYA(1).*cos(Pitch)+FYA(2).*cos(Pitch)-FPA(2).^2.*FYA(2).*cos(Pitch)-FPA(2).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(1).*sin(Pitch)-FPA(1).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(-sin(Pitch)+FPA(1).^2.*sin(Pitch))+FYA(2).*(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(3).*(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(1).*(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch))+FYA(2).*(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch))+FYA(3).*(-sin(Pitch)+FPA(3).^2.*sin(Pitch)))+(FPA(3).*FYA(1).*cos(Pitch)-FPA(1).*FYA(3).*cos(Pitch)+FPA(1).*FPA(2).*FYA(1).*sin(Pitch)-FYA(2).*sin(Pitch)+FPA(2).^2.*FYA(2).*sin(Pitch)+FPA(2).*FPA(3).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch)).*((1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*(FYA(1).*(-sin(Pitch)+FPA(1).^2.*sin(Pitch))+FYA(2).*(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(3).*(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(1).*(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(2).*(-sin(Pitch)+FPA(2).^2.*sin(Pitch))+FYA(3).*(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)))+(FPA(2).*FYA(1).*cos(Pitch)-FPA(1).*FYA(2).*cos(Pitch)-FPA(1).*FPA(3).*FYA(1).*sin(Pitch)-FPA(2).*FPA(3).*FYA(2).*sin(Pitch)+FYA(3).*sin(Pitch)-FPA(3).^2.*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Der_Matrix(1,3)=2*(1-cos(Yaw)).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(1).*(-sin(Pitch)+FPA(1).^2.*sin(Pitch))+FYA(2).*(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(3).*(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)))+(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).^2)+(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(-FPA(1).*FPA(3).*FYA(1)-FPA(2).*FPA(3).*FYA(2)-FPA(3).^2.*FYA(3)+FPA(1).*FPA(3).*FYA(1).*cos(Pitch)+FPA(2).*FPA(3).*FYA(2).*cos(Pitch)-FYA(3).*cos(Pitch)+FPA(3).^2.*FYA(3).*cos(Pitch)+FPA(2).*FYA(1).*sin(Pitch)-FPA(1).*FYA(2).*sin(Pitch)).*sin(Yaw))+(-sin(Pitch)+FPA(3).^2.*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)))+(FPA(1).*FPA(2).*FYA(1)+FPA(2).^2.*FYA(2)+FPA(2).*FPA(3).*FYA(3)-FPA(1).*FPA(2).*FYA(1).*cos(Pitch)+FYA(2).*cos(Pitch)-FPA(2).^2.*FYA(2).*cos(Pitch)-FPA(2).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(1).*sin(Pitch)-FPA(1).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(-sin(Pitch)+FPA(1).^2.*sin(Pitch))+FYA(2).*(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(3).*(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(1).*(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch))+FYA(2).*(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch))+FYA(3).*(-sin(Pitch)+FPA(3).^2.*sin(Pitch)))+(FPA(3).*FYA(1).*cos(Pitch)-FPA(1).*FYA(3).*cos(Pitch)+FPA(1).*FPA(2).*FYA(1).*sin(Pitch)-FYA(2).*sin(Pitch)+FPA(2).^2.*FYA(2).*sin(Pitch)+FPA(2).*FPA(3).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*(FYA(1).*(-sin(Pitch)+FPA(1).^2.*sin(Pitch))+FYA(2).*(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(3).*(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(1).*(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(2).*(-sin(Pitch)+FPA(2).^2.*sin(Pitch))+FYA(3).*(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)))+(FPA(2).*FYA(1).*cos(Pitch)-FPA(1).*FYA(2).*cos(Pitch)-FPA(1).*FPA(3).*FYA(1).*sin(Pitch)-FPA(2).*FPA(3).*FYA(2).*sin(Pitch)+FYA(3).*sin(Pitch)-FPA(3).^2.*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Der_Matrix(2,1)=2*(1-cos(Yaw)).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*(FYA(1).*(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(2).*(-sin(Pitch)+FPA(2).^2.*sin(Pitch))+FYA(3).*(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)))+(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).^2)+(-sin(Pitch)+FPA(1).^2.*sin(Pitch)).*((1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(FPA(1).*FPA(3).*FYA(1)+FPA(2).*FPA(3).*FYA(2)+FPA(3).^2.*FYA(3)-FPA(1).*FPA(3).*FYA(1).*cos(Pitch)-FPA(2).*FPA(3).*FYA(2).*cos(Pitch)+FYA(3).*cos(Pitch)-FPA(3).^2.*FYA(3).*cos(Pitch)-FPA(2).*FYA(1).*sin(Pitch)+FPA(1).*FYA(2).*sin(Pitch)).*sin(Yaw))+(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(-FPA(1).^2.*FYA(1)-FPA(1).*FPA(2).*FYA(2)-FPA(1).*FPA(3).*FYA(3)-FYA(1).*cos(Pitch)+FPA(1).^2.*FYA(1).*cos(Pitch)+FPA(1).*FPA(2).*FYA(2).*cos(Pitch)+FPA(1).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(2).*sin(Pitch)-FPA(2).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(2).*(-sin(Pitch)+FPA(2).^2.*sin(Pitch))+FYA(3).*(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*(FYA(1).*(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch))+FYA(2).*(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch))+FYA(3).*(-sin(Pitch)+FPA(3).^2.*sin(Pitch)))+(FPA(3).*FYA(2).*cos(Pitch)-FPA(2).*FYA(3).*cos(Pitch)+FYA(1).*sin(Pitch)-FPA(1).^2.*FYA(1).*sin(Pitch)-FPA(1).*FPA(2).*FYA(2).*sin(Pitch)-FPA(1).*FPA(3).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch)).*((1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*(FYA(1).*(-sin(Pitch)+FPA(1).^2.*sin(Pitch))+FYA(2).*(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(3).*(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(1).*(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(2).*(-sin(Pitch)+FPA(2).^2.*sin(Pitch))+FYA(3).*(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)))+(-FPA(2).*FYA(1).*cos(Pitch)+FPA(1).*FYA(2).*cos(Pitch)+FPA(1).*FPA(3).*FYA(1).*sin(Pitch)+FPA(2).*FPA(3).*FYA(2).*sin(Pitch)-FYA(3).*sin(Pitch)+FPA(3).^2.*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Der_Matrix(2,2)=2*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch)).*(1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*(FYA(1).*(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(2).*(-sin(Pitch)+FPA(2).^2.*sin(Pitch))+FYA(3).*(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)))+(-sin(Pitch)+FPA(2).^2.*sin(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).^2)+(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(FPA(1).*FPA(3).*FYA(1)+FPA(2).*FPA(3).*FYA(2)+FPA(3).^2.*FYA(3)-FPA(1).*FPA(3).*FYA(1).*cos(Pitch)-FPA(2).*FPA(3).*FYA(2).*cos(Pitch)+FYA(3).*cos(Pitch)-FPA(3).^2.*FYA(3).*cos(Pitch)-FPA(2).*FYA(1).*sin(Pitch)+FPA(1).*FYA(2).*sin(Pitch)).*sin(Yaw))+(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(-FPA(1).^2.*FYA(1)-FPA(1).*FPA(2).*FYA(2)-FPA(1).*FPA(3).*FYA(3)-FYA(1).*cos(Pitch)+FPA(1).^2.*FYA(1).*cos(Pitch)+FPA(1).*FPA(2).*FYA(2).*cos(Pitch)+FPA(1).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(2).*sin(Pitch)-FPA(2).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(2).*(-sin(Pitch)+FPA(2).^2.*sin(Pitch))+FYA(3).*(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*(FYA(1).*(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch))+FYA(2).*(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch))+FYA(3).*(-sin(Pitch)+FPA(3).^2.*sin(Pitch)))+(FPA(3).*FYA(2).*cos(Pitch)-FPA(2).*FYA(3).*cos(Pitch)+FYA(1).*sin(Pitch)-FPA(1).^2.*FYA(1).*sin(Pitch)-FPA(1).*FPA(2).*FYA(2).*sin(Pitch)-FPA(1).*FPA(3).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*(FYA(1).*(-sin(Pitch)+FPA(1).^2.*sin(Pitch))+FYA(2).*(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(3).*(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(1).*(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(2).*(-sin(Pitch)+FPA(2).^2.*sin(Pitch))+FYA(3).*(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)))+(-FPA(2).*FYA(1).*cos(Pitch)+FPA(1).*FYA(2).*cos(Pitch)+FPA(1).*FPA(3).*FYA(1).*sin(Pitch)+FPA(2).*FPA(3).*FYA(2).*sin(Pitch)-FYA(3).*sin(Pitch)+FPA(3).^2.*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Der_Matrix(2,3)=2*(1-cos(Yaw)).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*(FYA(1).*(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(2).*(-sin(Pitch)+FPA(2).^2.*sin(Pitch))+FYA(3).*(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)))+(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).^2)+(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(FPA(1).*FPA(3).*FYA(1)+FPA(2).*FPA(3).*FYA(2)+FPA(3).^2.*FYA(3)-FPA(1).*FPA(3).*FYA(1).*cos(Pitch)-FPA(2).*FPA(3).*FYA(2).*cos(Pitch)+FYA(3).*cos(Pitch)-FPA(3).^2.*FYA(3).*cos(Pitch)-FPA(2).*FYA(1).*sin(Pitch)+FPA(1).*FYA(2).*sin(Pitch)).*sin(Yaw))+(-sin(Pitch)+FPA(3).^2.*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(-FPA(1).^2.*FYA(1)-FPA(1).*FPA(2).*FYA(2)-FPA(1).*FPA(3).*FYA(3)-FYA(1).*cos(Pitch)+FPA(1).^2.*FYA(1).*cos(Pitch)+FPA(1).*FPA(2).*FYA(2).*cos(Pitch)+FPA(1).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(2).*sin(Pitch)-FPA(2).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(2).*(-sin(Pitch)+FPA(2).^2.*sin(Pitch))+FYA(3).*(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*(FYA(1).*(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch))+FYA(2).*(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch))+FYA(3).*(-sin(Pitch)+FPA(3).^2.*sin(Pitch)))+(FPA(3).*FYA(2).*cos(Pitch)-FPA(2).*FYA(3).*cos(Pitch)+FYA(1).*sin(Pitch)-FPA(1).^2.*FYA(1).*sin(Pitch)-FPA(1).*FPA(2).*FYA(2).*sin(Pitch)-FPA(1).*FPA(3).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*(FYA(1).*(-sin(Pitch)+FPA(1).^2.*sin(Pitch))+FYA(2).*(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(3).*(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(1).*(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(2).*(-sin(Pitch)+FPA(2).^2.*sin(Pitch))+FYA(3).*(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)))+(-FPA(2).*FYA(1).*cos(Pitch)+FPA(1).*FYA(2).*cos(Pitch)+FPA(1).*FPA(3).*FYA(1).*sin(Pitch)+FPA(2).*FPA(3).*FYA(2).*sin(Pitch)-FYA(3).*sin(Pitch)+FPA(3).^2.*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Der_Matrix(3,1)=2*(1-cos(Yaw)).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch))+FYA(2).*(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch))+FYA(3).*(-sin(Pitch)+FPA(3).^2.*sin(Pitch)))+(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).^2)+(-sin(Pitch)+FPA(1).^2.*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)))+(-FPA(1).*FPA(2).*FYA(1)-FPA(2).^2.*FYA(2)-FPA(2).*FPA(3).*FYA(3)+FPA(1).*FPA(2).*FYA(1).*cos(Pitch)-FYA(2).*cos(Pitch)+FPA(2).^2.*FYA(2).*cos(Pitch)+FPA(2).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(1).*sin(Pitch)+FPA(1).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(FPA(1).^2.*FYA(1)+FPA(1).*FPA(2).*FYA(2)+FPA(1).*FPA(3).*FYA(3)+FYA(1).*cos(Pitch)-FPA(1).^2.*FYA(1).*cos(Pitch)-FPA(1).*FPA(2).*FYA(2).*cos(Pitch)-FPA(1).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(2).*sin(Pitch)+FPA(2).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(2).*(-sin(Pitch)+FPA(2).^2.*sin(Pitch))+FYA(3).*(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*(FYA(1).*(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch))+FYA(2).*(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch))+FYA(3).*(-sin(Pitch)+FPA(3).^2.*sin(Pitch)))+(-FPA(3).*FYA(2).*cos(Pitch)+FPA(2).*FYA(3).*cos(Pitch)-FYA(1).*sin(Pitch)+FPA(1).^2.*FYA(1).*sin(Pitch)+FPA(1).*FPA(2).*FYA(2).*sin(Pitch)+FPA(1).*FPA(3).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(-sin(Pitch)+FPA(1).^2.*sin(Pitch))+FYA(2).*(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(3).*(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(1).*(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch))+FYA(2).*(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch))+FYA(3).*(-sin(Pitch)+FPA(3).^2.*sin(Pitch)))+(-FPA(3).*FYA(1).*cos(Pitch)+FPA(1).*FYA(3).*cos(Pitch)-FPA(1).*FPA(2).*FYA(1).*sin(Pitch)+FYA(2).*sin(Pitch)-FPA(2).^2.*FYA(2).*sin(Pitch)-FPA(2).*FPA(3).*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Der_Matrix(3,2)=2*(1-cos(Yaw)).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch))+FYA(2).*(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch))+FYA(3).*(-sin(Pitch)+FPA(3).^2.*sin(Pitch)))+(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).^2)+(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)))+(-FPA(1).*FPA(2).*FYA(1)-FPA(2).^2.*FYA(2)-FPA(2).*FPA(3).*FYA(3)+FPA(1).*FPA(2).*FYA(1).*cos(Pitch)-FYA(2).*cos(Pitch)+FPA(2).^2.*FYA(2).*cos(Pitch)+FPA(2).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(1).*sin(Pitch)+FPA(1).*FYA(3).*sin(Pitch)).*sin(Yaw))+(-sin(Pitch)+FPA(2).^2.*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(FPA(1).^2.*FYA(1)+FPA(1).*FPA(2).*FYA(2)+FPA(1).*FPA(3).*FYA(3)+FYA(1).*cos(Pitch)-FPA(1).^2.*FYA(1).*cos(Pitch)-FPA(1).*FPA(2).*FYA(2).*cos(Pitch)-FPA(1).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(2).*sin(Pitch)+FPA(2).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(2).*(-sin(Pitch)+FPA(2).^2.*sin(Pitch))+FYA(3).*(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*(FYA(1).*(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch))+FYA(2).*(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch))+FYA(3).*(-sin(Pitch)+FPA(3).^2.*sin(Pitch)))+(-FPA(3).*FYA(2).*cos(Pitch)+FPA(2).*FYA(3).*cos(Pitch)-FYA(1).*sin(Pitch)+FPA(1).^2.*FYA(1).*sin(Pitch)+FPA(1).*FPA(2).*FYA(2).*sin(Pitch)+FPA(1).*FPA(3).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(-sin(Pitch)+FPA(1).^2.*sin(Pitch))+FYA(2).*(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(3).*(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(1).*(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch))+FYA(2).*(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch))+FYA(3).*(-sin(Pitch)+FPA(3).^2.*sin(Pitch)))+(-FPA(3).*FYA(1).*cos(Pitch)+FPA(1).*FYA(3).*cos(Pitch)-FPA(1).*FPA(2).*FYA(1).*sin(Pitch)+FYA(2).*sin(Pitch)-FPA(2).^2.*FYA(2).*sin(Pitch)-FPA(2).*FPA(3).*FYA(3).*sin(Pitch)).*sin(Yaw));
                    Der_Matrix(3,3)=2*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch)).*(1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch))+FYA(2).*(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch))+FYA(3).*(-sin(Pitch)+FPA(3).^2.*sin(Pitch)))+(-sin(Pitch)+FPA(3).^2.*sin(Pitch)).*(cos(Yaw)+(1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).^2)+(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)))+(-FPA(1).*FPA(2).*FYA(1)-FPA(2).^2.*FYA(2)-FPA(2).*FPA(3).*FYA(3)+FPA(1).*FPA(2).*FYA(1).*cos(Pitch)-FYA(2).*cos(Pitch)+FPA(2).^2.*FYA(2).*cos(Pitch)+FPA(2).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(1).*sin(Pitch)+FPA(1).*FYA(3).*sin(Pitch)).*sin(Yaw))+(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)))+(FPA(1).^2.*FYA(1)+FPA(1).*FPA(2).*FYA(2)+FPA(1).*FPA(3).*FYA(3)+FYA(1).*cos(Pitch)-FPA(1).^2.*FYA(1).*cos(Pitch)-FPA(1).*FPA(2).*FYA(2).*cos(Pitch)-FPA(1).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(2).*sin(Pitch)+FPA(2).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(2).*(-sin(Pitch)+FPA(2).^2.*sin(Pitch))+FYA(3).*(-FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*(FYA(1).*(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch))+FYA(2).*(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch))+FYA(3).*(-sin(Pitch)+FPA(3).^2.*sin(Pitch)))+(-FPA(3).*FYA(2).*cos(Pitch)+FPA(2).*FYA(3).*cos(Pitch)-FYA(1).*sin(Pitch)+FPA(1).^2.*FYA(1).*sin(Pitch)+FPA(1).*FPA(2).*FYA(2).*sin(Pitch)+FPA(1).*FPA(3).*FYA(3).*sin(Pitch)).*sin(Yaw))+(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch)).*((1-cos(Yaw)).*(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(-sin(Pitch)+FPA(1).^2.*sin(Pitch))+FYA(2).*(-FPA(3).*cos(Pitch)+FPA(1).*FPA(2).*sin(Pitch))+FYA(3).*(FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch)))+(1-cos(Yaw)).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(1).*(-FPA(2).*cos(Pitch)+FPA(1).*FPA(3).*sin(Pitch))+FYA(2).*(FPA(1).*cos(Pitch)+FPA(2).*FPA(3).*sin(Pitch))+FYA(3).*(-sin(Pitch)+FPA(3).^2.*sin(Pitch)))+(-FPA(3).*FYA(1).*cos(Pitch)+FPA(1).*FYA(3).*cos(Pitch)-FPA(1).*FPA(2).*FYA(1).*sin(Pitch)+FYA(2).*sin(Pitch)-FPA(2).^2.*FYA(2).*sin(Pitch)-FPA(2).*FPA(3).*FYA(3).*sin(Pitch)).*sin(Yaw));
                    
                    yDer_Matrix=zeros(3);
                    yDer_Matrix(1,1)=(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch)).*(cos(Yaw).*(FPA(1).*FPA(2).*FYA(1)+FPA(2).^2.*FYA(2)+FPA(2).*FPA(3).*FYA(3)-FPA(1).*FPA(2).*FYA(1).*cos(Pitch)+FYA(2).*cos(Pitch)-FPA(2).^2.*FYA(2).*cos(Pitch)-FPA(2).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(1).*sin(Pitch)-FPA(1).*FYA(3).*sin(Pitch))+(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*sin(Yaw))+(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch)).*(-sin(Yaw)+(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).^2.*sin(Yaw))+(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)).*(cos(Yaw).*(-FPA(1).*FPA(3).*FYA(1)-FPA(2).*FPA(3).*FYA(2)-FPA(3).^2.*FYA(3)+FPA(1).*FPA(3).*FYA(1).*cos(Pitch)+FPA(2).*FPA(3).*FYA(2).*cos(Pitch)-FYA(3).*cos(Pitch)+FPA(3).^2.*FYA(3).*cos(Pitch)+FPA(2).*FYA(1).*sin(Pitch)-FPA(1).*FYA(2).*sin(Pitch))+(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*sin(Yaw));
                    yDer_Matrix(1,2)=(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch)).*(cos(Yaw).*(FPA(1).*FPA(2).*FYA(1)+FPA(2).^2.*FYA(2)+FPA(2).*FPA(3).*FYA(3)-FPA(1).*FPA(2).*FYA(1).*cos(Pitch)+FYA(2).*cos(Pitch)-FPA(2).^2.*FYA(2).*cos(Pitch)-FPA(2).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(1).*sin(Pitch)-FPA(1).*FYA(3).*sin(Pitch))+(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*sin(Yaw))+(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)).*(-sin(Yaw)+(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).^2.*sin(Yaw))+(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch)).*(cos(Yaw).*(-FPA(1).*FPA(3).*FYA(1)-FPA(2).*FPA(3).*FYA(2)-FPA(3).^2.*FYA(3)+FPA(1).*FPA(3).*FYA(1).*cos(Pitch)+FPA(2).*FPA(3).*FYA(2).*cos(Pitch)-FYA(3).*cos(Pitch)+FPA(3).^2.*FYA(3).*cos(Pitch)+FPA(2).*FYA(1).*sin(Pitch)-FPA(1).*FYA(2).*sin(Pitch))+(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*sin(Yaw));
                    yDer_Matrix(1,3)=(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch)).*(cos(Yaw).*(FPA(1).*FPA(2).*FYA(1)+FPA(2).^2.*FYA(2)+FPA(2).*FPA(3).*FYA(3)-FPA(1).*FPA(2).*FYA(1).*cos(Pitch)+FYA(2).*cos(Pitch)-FPA(2).^2.*FYA(2).*cos(Pitch)-FPA(2).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(1).*sin(Pitch)-FPA(1).*FYA(3).*sin(Pitch))+(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*sin(Yaw))+(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch)).*(-sin(Yaw)+(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).^2.*sin(Yaw))+(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch)).*(cos(Yaw).*(-FPA(1).*FPA(3).*FYA(1)-FPA(2).*FPA(3).*FYA(2)-FPA(3).^2.*FYA(3)+FPA(1).*FPA(3).*FYA(1).*cos(Pitch)+FPA(2).*FPA(3).*FYA(2).*cos(Pitch)-FYA(3).*cos(Pitch)+FPA(3).^2.*FYA(3).*cos(Pitch)+FPA(2).*FYA(1).*sin(Pitch)-FPA(1).*FYA(2).*sin(Pitch))+(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*sin(Yaw));
                    yDer_Matrix(2,1)=(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch)).*(cos(Yaw).*(-FPA(1).^2.*FYA(1)-FPA(1).*FPA(2).*FYA(2)-FPA(1).*FPA(3).*FYA(3)-FYA(1).*cos(Pitch)+FPA(1).^2.*FYA(1).*cos(Pitch)+FPA(1).*FPA(2).*FYA(2).*cos(Pitch)+FPA(1).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(2).*sin(Pitch)-FPA(2).*FYA(3).*sin(Pitch))+(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*sin(Yaw))+(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch)).*(cos(Yaw).*(FPA(1).*FPA(3).*FYA(1)+FPA(2).*FPA(3).*FYA(2)+FPA(3).^2.*FYA(3)-FPA(1).*FPA(3).*FYA(1).*cos(Pitch)-FPA(2).*FPA(3).*FYA(2).*cos(Pitch)+FYA(3).*cos(Pitch)-FPA(3).^2.*FYA(3).*cos(Pitch)-FPA(2).*FYA(1).*sin(Pitch)+FPA(1).*FYA(2).*sin(Pitch))+(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*sin(Yaw))+(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)).*(-sin(Yaw)+(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).^2.*sin(Yaw));
                    yDer_Matrix(2,2)=(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch)).*(cos(Yaw).*(-FPA(1).^2.*FYA(1)-FPA(1).*FPA(2).*FYA(2)-FPA(1).*FPA(3).*FYA(3)-FYA(1).*cos(Pitch)+FPA(1).^2.*FYA(1).*cos(Pitch)+FPA(1).*FPA(2).*FYA(2).*cos(Pitch)+FPA(1).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(2).*sin(Pitch)-FPA(2).*FYA(3).*sin(Pitch))+(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*sin(Yaw))+(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)).*(cos(Yaw).*(FPA(1).*FPA(3).*FYA(1)+FPA(2).*FPA(3).*FYA(2)+FPA(3).^2.*FYA(3)-FPA(1).*FPA(3).*FYA(1).*cos(Pitch)-FPA(2).*FPA(3).*FYA(2).*cos(Pitch)+FYA(3).*cos(Pitch)-FPA(3).^2.*FYA(3).*cos(Pitch)-FPA(2).*FYA(1).*sin(Pitch)+FPA(1).*FYA(2).*sin(Pitch))+(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*sin(Yaw))+(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch)).*(-sin(Yaw)+(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).^2.*sin(Yaw));
                    yDer_Matrix(2,3)=(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch)).*(cos(Yaw).*(-FPA(1).^2.*FYA(1)-FPA(1).*FPA(2).*FYA(2)-FPA(1).*FPA(3).*FYA(3)-FYA(1).*cos(Pitch)+FPA(1).^2.*FYA(1).*cos(Pitch)+FPA(1).*FPA(2).*FYA(2).*cos(Pitch)+FPA(1).*FPA(3).*FYA(3).*cos(Pitch)+FPA(3).*FYA(2).*sin(Pitch)-FPA(2).*FYA(3).*sin(Pitch))+(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*sin(Yaw))+(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch)).*(cos(Yaw).*(FPA(1).*FPA(3).*FYA(1)+FPA(2).*FPA(3).*FYA(2)+FPA(3).^2.*FYA(3)-FPA(1).*FPA(3).*FYA(1).*cos(Pitch)-FPA(2).*FPA(3).*FYA(2).*cos(Pitch)+FYA(3).*cos(Pitch)-FPA(3).^2.*FYA(3).*cos(Pitch)-FPA(2).*FYA(1).*sin(Pitch)+FPA(1).*FYA(2).*sin(Pitch))+(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*sin(Yaw))+(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch)).*(-sin(Yaw)+(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).^2.*sin(Yaw));
                    yDer_Matrix(3,1)=(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch)).*(-sin(Yaw)+(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).^2.*sin(Yaw))+(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch)).*(cos(Yaw).*(-FPA(1).*FPA(2).*FYA(1)-FPA(2).^2.*FYA(2)-FPA(2).*FPA(3).*FYA(3)+FPA(1).*FPA(2).*FYA(1).*cos(Pitch)-FYA(2).*cos(Pitch)+FPA(2).^2.*FYA(2).*cos(Pitch)+FPA(2).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(1).*sin(Pitch)+FPA(1).*FYA(3).*sin(Pitch))+(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*sin(Yaw))+(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch)).*(cos(Yaw).*(FPA(1).^2.*FYA(1)+FPA(1).*FPA(2).*FYA(2)+FPA(1).*FPA(3).*FYA(3)+FYA(1).*cos(Pitch)-FPA(1).^2.*FYA(1).*cos(Pitch)-FPA(1).*FPA(2).*FYA(2).*cos(Pitch)-FPA(1).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(2).*sin(Pitch)+FPA(2).*FYA(3).*sin(Pitch))+(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*sin(Yaw));
                    yDer_Matrix(3,2)=(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch)).*(-sin(Yaw)+(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).^2.*sin(Yaw))+(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch)).*(cos(Yaw).*(-FPA(1).*FPA(2).*FYA(1)-FPA(2).^2.*FYA(2)-FPA(2).*FPA(3).*FYA(3)+FPA(1).*FPA(2).*FYA(1).*cos(Pitch)-FYA(2).*cos(Pitch)+FPA(2).^2.*FYA(2).*cos(Pitch)+FPA(2).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(1).*sin(Pitch)+FPA(1).*FYA(3).*sin(Pitch))+(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*sin(Yaw))+(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch)).*(cos(Yaw).*(FPA(1).^2.*FYA(1)+FPA(1).*FPA(2).*FYA(2)+FPA(1).*FPA(3).*FYA(3)+FYA(1).*cos(Pitch)-FPA(1).^2.*FYA(1).*cos(Pitch)-FPA(1).*FPA(2).*FYA(2).*cos(Pitch)-FPA(1).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(2).*sin(Pitch)+FPA(2).*FYA(3).*sin(Pitch))+(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*sin(Yaw));
                    yDer_Matrix(3,3)=(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch)).*(-sin(Yaw)+(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).^2.*sin(Yaw))+(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch)).*(cos(Yaw).*(-FPA(1).*FPA(2).*FYA(1)-FPA(2).^2.*FYA(2)-FPA(2).*FPA(3).*FYA(3)+FPA(1).*FPA(2).*FYA(1).*cos(Pitch)-FYA(2).*cos(Pitch)+FPA(2).^2.*FYA(2).*cos(Pitch)+FPA(2).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(1).*sin(Pitch)+FPA(1).*FYA(3).*sin(Pitch))+(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(1).*(FPA(1).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(1).*FPA(3).*(1-cos(Pitch))+FPA(2).*sin(Pitch))+FYA(2).*(FPA(1).*FPA(2).*(1-cos(Pitch))-FPA(3).*sin(Pitch))).*sin(Yaw))+(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch)).*(cos(Yaw).*(FPA(1).^2.*FYA(1)+FPA(1).*FPA(2).*FYA(2)+FPA(1).*FPA(3).*FYA(3)+FYA(1).*cos(Pitch)-FPA(1).^2.*FYA(1).*cos(Pitch)-FPA(1).*FPA(2).*FYA(2).*cos(Pitch)-FPA(1).*FPA(3).*FYA(3).*cos(Pitch)-FPA(3).*FYA(2).*sin(Pitch)+FPA(2).*FYA(3).*sin(Pitch))+(FYA(3).*(FPA(3).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(2).*(FPA(2).*FPA(3).*(1-cos(Pitch))+FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(3).*(1-cos(Pitch))-FPA(2).*sin(Pitch))).*(FYA(2).*(FPA(2).^2.*(1-cos(Pitch))+cos(Pitch))+FYA(3).*(FPA(2).*FPA(3).*(1-cos(Pitch))-FPA(1).*sin(Pitch))+FYA(1).*(FPA(1).*FPA(2).*(1-cos(Pitch))+FPA(3).*sin(Pitch))).*sin(Yaw));
            
                    Reflectionsnorm=sqrt(sum(Reflections.^2));
                    Valois=(((CDS.BeamPropagation.'*Rot_Matrix*MZero*Reflections)/norm(CDS.BeamPropagation))./Reflectionsnorm);     
                    PhotonEnergy=obj.hplanck*obj.cluce./(abs(2*(obj.LatticeConstant./Reflectionsnorm).*sin(pi/2 - acos(Valois))));
                    PhotonEnergyDer = -(sign(Valois)./Valois.^2).*Reflectionsnorm/180*pi.*obj.hplanck.*obj.cluce./obj.LatticeConstant./2.*(((CDS.BeamPropagation.'*Der_Matrix*MZero*Reflections)/norm(CDS.BeamPropagation))./Reflectionsnorm);
                    PhotonEnergyDerYaw = -(sign(Valois)./Valois.^2).*Reflectionsnorm/180*pi.*obj.hplanck.*obj.cluce./obj.LatticeConstant./2.*(((CDS.BeamPropagation.'*yDer_Matrix*MZero*Reflections)/norm(CDS.BeamPropagation))./Reflectionsnorm);
        end
        
        function out=InitialRotation(obj)
            R1=obj.Rot_vector_onto_vector(obj.MainCut,obj.AtPitchYawRollEqual0_MainCutIsOn);
            if(isrow(obj.SecondaryCut))
                R2=obj.Rot_vector_onto_vector(R1*obj.SecondaryCut.',obj.AtPitchYawRollEqual0_SecondaryCutIsOn);
            else
                R2=obj.Rot_vector_onto_vector(R1*obj.SecondaryCut,obj.AtPitchYawRollEqual0_SecondaryCutIsOn);
            end
            out=R2*R1;
        end
        
        function out=CrystalInHolder(obj)
            out=obj.Rz(obj.Erz)*obj.Rx(obj.Erx)*obj.Ry(obj.Ery);
        end
        
        function out=PitchAxis(obj)
            out=obj.Rz(obj.PAze)*obj.Rx(obj.PAxe)*obj.Ry(obj.PAye)*obj.PITCH_AXIS;
        end
        function out=YawAxis(obj,PitchAngle)
            out=obj.Arb_Rot(PitchAngle,obj.Rz(obj.PAze)*obj.Rx(obj.PAxe)*obj.Ry(obj.PAye)*obj.PITCH_AXIS)*(obj.Rz(obj.YAze)*obj.Rx(obj.YAxe)*obj.Ry(obj.YAye)*obj.YAW_AXIS);
        end
        
        function out=RotationStages_deg_input(obj,PitchAngle,YawAngle)
            out=obj.Arb_Rot((YawAngle*obj.Yaw_Scale+obj.Yaw_Offset)/180*pi,obj.YawAxis(((PitchAngle-90)*obj.Pitch_Scale+90+obj.Pitch_Offset)/180*pi))*obj.Arb_Rot(((PitchAngle-90)*obj.Pitch_Scale+90+obj.Pitch_Offset)/180*pi,obj.PitchAxis());
        end
        
        function Matrix_Rot=Rot_vector_onto_vector(obj,v1,v2)
            if(norm(cross(v1,v2))>10^-15)
                Matrix_Rot=obj.Arb_Rot(acos(dot(v1,v2)/norm(v1)/norm(v2)),cross(v1,v2)/norm(v1)/norm(v2));
            else
                Matrix_Rot=eye(3);
            end
        end

        function out=FullRotation_deg_input(obj,PitchAngle,YawAngle)
            out=obj.RotationStages_deg_input(PitchAngle,YawAngle)*obj.CrystalInHolder()*obj.InitialRotation();
        end

        function out=deg2rad(obj,in), out=in/180*pi; end
        function out=rad2deg(obj,in), out=180*in/pi; end
        function set_lattice_constant(obj,in)
            if(ischar(in))
                switch(in)
                    case {'diamond','DIAMOND','Diamond','C'}
                        obj.LatticeConstant=0.356683*10^(-9);
                    case {'silicon','SILICON','Silicon','Si'}
                        obj.LatticeConstant=5.431020511*10^(-10);
                    case {'germanium','GERMANIUM','Germanium','Ge'}
                        obj.LatticeConstant=5.6575*10^(-10);
                    otherwise
                        disp('not recognized material, setting as diamond')
                        obj.LatticeConstant=0.356683*10^(-9);
                end
            else
                disp(['Lattice constant set as ',num2str(in),' m.'])
                obj.LatticeConstant=in;
            end
        end
        function set_parameter(obj,parameter,value)
           obj.(parameter)=value;
           obj.Evaluate_MZero_and_Constants();
        end
        function set_crystal(obj,CD)
            for II=1:length(obj.variables)
               if(isfield(CD,obj.variables{II})), obj.(obj.variables{II})=CD.(obj.variables{II}); end 
            end 
            obj.Evaluate_MZero_and_Constants();
            obj.ROLL_AXIS=cross(obj.PITCH_AXIS,obj.YAW_AXIS);
        end
        function CD=get_crystal(obj)
            for II=1:length(obj.variables)
               CD.(obj.variables{II})=obj.(obj.variables{II});
            end 
        end
        function R_Matrix=Rx(obj,angle)
            R_Matrix=[1,0,0;0,cos(angle),-sin(angle);0,sin(angle),cos(angle)];
        end
        function R_Matrix=Ry(obj,angle)
            R_Matrix=[cos(angle),0,sin(angle);0,1,0;-sin(angle),0,cos(angle)];
        end
        function R_Matrix=Rz(obj,angle)
            R_Matrix=[cos(angle),-sin(angle),0;sin(angle),cos(angle),0;0,0,1];
        end
        function out=f_u(obj,Vector)
            if(iscolumn(Vector))
                Vector=transpose(Vector);
            end
            out=[cross([1;0;0],Vector);cross([0;1;0],Vector);cross([0;0;1],Vector)];
        end
        
        function out=f_tu(obj,Vector)
            if(iscolumn(Vector))
                out=Vector*Vector.';
            else
                out=Vector.'*Vector;
            end
        end
        
        function out=f_cu(obj,Vector)
            if(iscolumn(Vector))
                Vector=transpose(Vector);
            end
            out=[cross([1;0;0],Vector);cross([0;1;0],Vector);cross([0;0;1],Vector)];
        end
        
        function Rot_Mat=Arb_Rot(obj,angle, Vect)
            if(abs(norm(Vect)-1)>eps)
                Rot_Mat=eye(3)*cos(angle) +  sin(angle)*obj.f_cu(Vect/norm(Vect)) + (1-cos(angle))*obj.f_tu(Vect/norm(Vect));
            else
                Rot_Mat=eye(3)*cos(angle) +  sin(angle)*obj.f_cu(Vect) + (1-cos(angle))*obj.f_tu(Vect);
            end    
        end
               
        function findAllReflections(obj,maxAbsIndex,maxSumSquare)
            if(nargin<3), maxSumSquare=inf; end
            AlsoForbiddenPM=(2*maxAbsIndex+1);
            VerticalList=(-maxAbsIndex:maxAbsIndex).';
            Col1=repmat(VerticalList,[AlsoForbiddenPM^2,1]);
            Col2=(reshape(Col1,[AlsoForbiddenPM^2,AlsoForbiddenPM]).');
            Col2=Col2(:);
            Col3=(reshape(Col2,[AlsoForbiddenPM^2,AlsoForbiddenPM]).');
            Col3=Col3(:);
            Include=(mod(Col1,2) & mod(Col2,2) & mod(Col3,2)) | (~mod(Col1,2) & ~mod(Col2,2) & ~mod(Col3,2)) & (~mod(Col1+Col2+Col3,4) );
            Reflections=[Col1(Include),Col2(Include),Col3(Include)];
            Remove=find(all(Reflections.'==0));
            Reflections(Remove,:)=[]; %#ok<FNDSB>
            ind=1;
            while(ind<size(Reflections,1))
                remove= find((Reflections(:,1)== -Reflections(ind,1)) & (Reflections(:,2)== -Reflections(ind,2))& (Reflections(:,3)== -Reflections(ind,3)));
                Reflections(remove,:)=[]; %#ok<FNDSB>
                ind=ind+1;
            end
            Reflections=-Reflections;
            SumSquare=Reflections(:,1).^2+Reflections(:,2).^2 + Reflections(:,3).^2;
            [obj.AllReflectionsSqrsum,SortingOrder]=sort(SumSquare,'ascend');
            obj.AllReflections=Reflections(SortingOrder,:);
            obj.AllReflectionsAbsMax=max(abs(obj.AllReflections.')).';
            
            obj.AllReflectionsSqrsum=obj.AllReflectionsSqrsum(obj.AllReflectionsSqrsum<=maxSumSquare);
            obj.AllReflections=obj.AllReflections(obj.AllReflectionsSqrsum<=maxSumSquare,:);
            obj.AllReflectionsAbsMax=obj.AllReflectionsAbsMax(obj.AllReflectionsSqrsum<=maxSumSquare,:);
        end
        
        function [Angles,Energies]=FindAnglesTwoColor(obj, StartAngle, Reflections, TargetEnergies)
            Angles=fminsearch(@(X) obj.TwoColorError(X, Reflections,TargetEnergies),StartAngle);
            Energies=obj.PhotonEnergy_fast_formula(Angles(1), Angles(2), Reflections);
        end
        
        function Err=TwoColorError(obj,Angles,Reflections,TargetEnergies)
            PHE=obj.PhotonEnergy_fast_formula(Angles(1), Angles(2), Reflections);
            Err=sum(abs(PHE-TargetEnergies));
        end
        
        function Err=TwoColorCrossingError(obj,Angles,Reflections)
            PHE=obj.PhotonEnergy_fast_formula(CD, Angles(1), Angles(2), Reflections);
            Err=abs(PHE(1)-PHE(2));
        end
        
        function Err=SingleColorError(obj,MovingAngle,FixedAngle,MovePitch,Reflections,TargetEnergies)
            if(MovePitch)
                PHE=obj.PhotonEnergy_fast_formula(MovingAngle, FixedAngle, Reflections);
            else
                PHE=obj.PhotonEnergy_fast_formula(FixedAngle, MovingAngle, Reflections);
            end
            Err=sum(abs(PHE-TargetEnergies));
        end
        
        function [Angles,Energy]=FindAnglesOneColor(obj, StartAngle, Reflection, UsePitch,TargetEnergies)
            if(~isnan(UsePitch))
                if(UsePitch)
                    Angles(1)=fminsearch(@(X) obj.SingleColorError(X,StartAngle(2),1, Reflection,TargetEnergies),StartAngle(1));
                    Angles(2)=StartAngle(2);
                else
                    Angles(1)=StartAngle(1);
                    Angles(2)=fminsearch(@(X) obj.SingleColorError(X,StartAngle(1),0,Reflection,TargetEnergies),StartAngle(2));
                end
            else
                Angles=fminsearch(@(X) obj.TwoColorError(X,[Reflection,Reflection],[TargetEnergies,TargetEnergies]),StartAngle);
            end
            Energy=obj.PhotonEnergy_fast_formula(Angles(1), Angles(2), Reflection);
        end
        
%         function [Scan, parameters]=MakeUpProblem(obj,parameters,parameters_range)
%             for II=1:numel(parameters)
%                 
%             end
%             X0=zeros(size(Fittingon));
%             for II=1:numel(Fittingon)
%                X0(II)=obj.(Fittingon{II}); 
%             end
%             
%         end
        
        function Set_f1f2(obj)
            [~,POS]=min(abs(obj.LatticeConstant - [0.356683*10^(-9),5.431020511*10^(-10),5.6575*(10^-10)] ));
            if(POS==3),POS=1;end 
            switch(POS)
                case 1
                    obj.f1f2=[[2025.20,6.16594,0.168474,];[2057.95,6.16261,0.163292,];[2091.24,6.15928,0.158263,];[2125.06,6.15600,0.153384,];[2159.43,6.15276,0.148648,];[2194.36,6.14957,0.144053,];[2229.85,6.14643,0.139593,];[2265.92,6.14334,0.135267,];[2302.57,6.14028,0.131069,];[2339.81,6.13729,0.126998,];[2377.66,6.13433,0.123042,];[2416.11,6.13143,0.119210,];[2455.19,6.12857,0.115492,];[2494.90,6.12576,0.111882,];[2535.26,6.12300,0.108383,];[2576.26,6.12028,0.104990,];[2617.93,6.11762,0.101694,];[2660.27,6.11500,0.985042E-01];[2703.30,6.11243,0.954028E-01];[2747.03,6.10990,0.923971E-01];[2791.46,6.10742,0.894832E-01];[2836.61,6.10498,0.866617E-01];[2882.49,6.10259,0.839148E-01];[2929.11,6.10024,0.812599E-01];[2976.48,6.09794,0.786821E-01];[3024.63,6.09569,0.761825E-01];[3073.55,6.09347,0.737584E-01];[3123.26,6.09130,0.714080E-01];[3173.78,6.08917,0.691288E-01];[3225.11,6.08708,0.669194E-01];[3277.27,6.08503,0.647767E-01];[3330.28,6.08302,0.626991E-01];[3384.15,6.08105,0.606853E-01];[3438.88,6.07912,0.587327E-01];[3494.50,6.07723,0.568396E-01];[3551.02,6.07538,0.550042E-01];[3608.46,6.07357,0.532244E-01];[3666.82,6.07179,0.514997E-01];[3726.13,6.07005,0.498278E-01];[3786.40,6.06834,0.482071E-01];[3847.64,6.06667,0.466352E-01];[3909.87,6.06504,0.451127E-01];[3973.11,6.06343,0.436367E-01];[4037.38,6.06186,0.422212E-01];[4102.68,6.06033,0.408351E-01];[4169.03,6.05883,0.394919E-01];[4236.46,6.05736,0.381921E-01];[4304.98,6.05592,0.369324E-01];[4374.62,6.05451,0.357130E-01];[4445.37,6.05313,0.345329E-01];[4517.27,6.05178,0.333896E-01];[4590.33,6.05046,0.322825E-01];[4664.58,6.04917,0.312100E-01];[4740.03,6.04791,0.301723E-01];[4816.69,6.04667,0.291678E-01];[4894.60,6.04547,0.281953E-01];[4973.77,6.04429,0.272539E-01];[5054.21,6.04313,0.263428E-01];[5135.96,6.04200,0.254606E-01];[5219.03,6.04090,0.246074E-01];[5303.44,6.03983,0.237810E-01];[5389.22,6.03877,0.229809E-01];[5476.39,6.03774,0.222063E-01];[5564.97,6.03674,0.214569E-01];[5654.98,6.03576,0.207329E-01];[5746.44,6.03480,0.200314E-01];[5839.39,6.03386,0.193522E-01];[5933.83,6.03295,0.186948E-01];[6029.81,6.03205,0.180595E-01];[6127.33,6.03118,0.174453E-01];[6226.44,6.03033,0.168501E-01];[6327.15,6.02950,0.162746E-01];[6429.48,6.02869,0.157180E-01];[6533.48,6.02789,0.151795E-01];[6639.15,6.02712,0.146587E-01];[6746.54,6.02637,0.141549E-01];[6855.65,6.02563,0.136678E-01];[6966.54,6.02491,0.131966E-01];[7079.22,6.02421,0.127407E-01];[7193.72,6.02352,0.123000E-01];[7310.07,6.02285,0.118738E-01];[7428.31,6.02220,0.114619E-01];[7548.45,6.02156,0.110634E-01];[7670.54,6.02094,0.106782E-01];[7794.61,6.02034,0.103059E-01];[7920.68,6.01975,0.994583E-02];[8048.79,6.01917,0.959775E-02];[8178.98,6.01861,0.926134E-02];[8311.26,6.01806,0.893624E-02];[8445.69,6.01753,0.862190E-02];[8582.29,6.01700,0.831820E-02];[8721.11,6.01650,0.802475E-02];[8862.16,6.01600,0.774104E-02];[9005.50,6.01552,0.746686E-02];[9151.16,6.01505,0.720204E-02];[9299.17,6.01459,0.694614E-02];[9449.58,6.01414,0.669902E-02];[9602.42,6.01370,0.646026E-02];[9757.73,6.01328,0.622938E-02];[9915.55,6.01286,0.600659E-02];[10075.9,6.01246,0.579136E-02];[10238.9,6.01206,0.558350E-02];[10404.5,6.01168,0.538276E-02];[10572.8,6.01131,0.518891E-02];[10743.8,6.01094,0.500173E-02];[10917.6,6.01059,0.482101E-02];[11094.2,6.01024,0.464654E-02];[11273.6,6.00991,0.447810E-02];[11455.9,6.00958,0.431552E-02];[11641.2,6.00926,0.415859E-02];[11829.5,6.00895,0.400712E-02];[12020.8,6.00864,0.386096E-02];[12215.3,6.00835,0.371991E-02];[12412.8,6.00806,0.358382E-02];[12613.6,6.00778,0.345251E-02];[12817.6,6.00751,0.332584E-02];[13025.0,6.00724,0.320365E-02];[13235.6,6.00698,0.308580E-02];[13449.7,6.00673,0.297213E-02];[13667.2,6.00648,0.286252E-02];[13888.3,6.00625,0.275683E-02];[14112.9,6.00601,0.265492E-02];[14341.2,6.00579,0.255668E-02];[14573.1,6.00557,0.246198E-02];[14808.9,6.00535,0.237071E-02];[15048.4,6.00514,0.228275E-02];[15291.8,6.00494,0.219799E-02];[15539.1,6.00474,0.211632E-02];[15790.4,6.00455,0.203764E-02];[16045.8,6.00436,0.196186E-02];[16305.4,6.00418,0.188887E-02];[16569.1,6.00400,0.181858E-02];[16837.1,6.00383,0.175089E-02];[17109.4,6.00366,0.168574E-02];[17386.1,6.00350,0.162301E-02];[17667.4,6.00334,0.156265E-02];[17953.1,6.00319,0.150455E-02];[18243.5,6.00304,0.144866E-02];[18538.6,6.00289,0.139489E-02];[18838.4,6.00275,0.134317E-02];[19143.1,6.00261,0.129343E-02];[19452.7,6.00248,0.124561E-02];[19767.4,6.00235,0.119964E-02];[20087.1,6.00222,0.116295E-02];[20412.0,6.00211,0.111818E-02];[20742.1,6.00199,0.107519E-02];[21077.6,6.00187,0.103391E-02];[21418.5,6.00176,0.994268E-03];[21765.0,6.00165,0.956195E-03];[22117.0,6.00154,0.919629E-03];[22474.7,6.00144,0.884508E-03];[22838.2,6.00134,0.850771E-03];[23207.6,6.00124,0.818364E-03];[23583.0,6.00115,0.787230E-03];[23964.4,6.00105,0.757320E-03];[24352.0,6.00096,0.728582E-03];[24745.9,6.00088,0.700971E-03];[25146.2,6.00079,0.674438E-03];[25552.9,6.00071,0.648942E-03];[25966.2,6.00063,0.624439E-03];[26386.1,6.00055,0.600890E-03];[26812.9,6.00048,0.578257E-03];[27246.6,6.00040,0.556501E-03];[27687.3,6.00033,0.535590E-03];[28135.1,6.00026,0.515487E-03];[28590.2,6.00020,0.496161E-03];[29052.6,6.00013,0.477581E-03];[29522.5,6.00007,0.459716E-03];[30000.0,6.00000,0.442540E-03]];
         
                case 2
                    obj.f1f2=[[2015.37,12.1301,3.65896,];[2047.96,12.3571,3.57698,];[2081.09,12.5533,3.49664,];[2114.75,12.7254,3.41523,];[2148.95,12.8775,3.33521,];[2183.71,13.0131,3.25641,];[2219.03,13.1350,3.17868,];[2254.92,13.2452,3.10245,];[2291.39,13.3453,3.02741,];[2328.45,13.4369,2.95359,];[2366.11,13.5205,2.88121,];[2404.38,13.5972,2.80993,];[2443.27,13.6676,2.74011,];[2482.79,13.7324,2.67152,];[2522.95,13.7921,2.60424,];[2563.75,13.8472,2.53844,];[2605.22,13.8981,2.47374,];[2647.36,13.9449,2.41045,];[2690.18,13.9882,2.34854,];[2733.69,14.0282,2.28769,];[2777.90,14.0651,2.22827,];[2822.83,14.0991,2.17014,];[2868.49,14.1305,2.11320,];[2914.89,14.1594,2.05756,];[2962.03,14.1859,2.00307,];[3009.94,14.2104,1.94988,];[3058.62,14.2329,1.89788,];[3108.09,14.2535,1.84703,];[3158.37,14.2723,1.79742,];[3209.45,14.2894,1.74890,];[3261.36,14.3051,1.70154,];[3314.11,14.3194,1.65534,];[3367.71,14.3322,1.61015,];[3422.18,14.3438,1.56612,];[3477.53,14.3542,1.52314,];[3533.78,14.3635,1.48119,];[3590.94,14.3718,1.44032,];[3649.02,14.3791,1.40039,];[3708.04,14.3855,1.36149,];[3768.01,14.3910,1.32359,];[3828.96,14.3957,1.28658,];[3890.89,14.3997,1.25056,];[3953.82,14.4029,1.21543,];[4017.77,14.4055,1.18120,];[4082.75,14.4075,1.14788,];[4148.79,14.4089,1.11537,];[4215.89,14.4097,1.08375,];[4284.08,14.4101,1.05295,];[4353.37,14.4100,1.02294,];[4423.78,14.4094,0.993744,];[4495.33,14.4085,0.965295,];[4568.04,14.4071,0.937606,];[4641.93,14.4054,0.910663,];[4717.01,14.4034,0.884415,];[4793.30,14.4011,0.858896,];[4870.83,14.3984,0.834074,];[4949.61,14.3956,0.809917,];[5029.67,14.3925,0.786429,];[5111.02,14.3891,0.763535,];[5193.68,14.3856,0.741289,];[5277.69,14.3818,0.719672,];[5363.05,14.3779,0.698635,];[5449.79,14.3739,0.678189,];[5537.94,14.3697,0.658294,];[5627.51,14.3654,0.638950,];[5718.53,14.3609,0.620147,];[5811.02,14.3564,0.601873,];[5905.01,14.3517,0.584116,];[6000.52,14.3470,0.566843,];[6097.57,14.3422,0.550055,];[6196.20,14.3374,0.533751,];[6296.42,14.3325,0.517913,];[6349.,14.3300,0.509889,];[6432.,14.3259,0.497536,];[6536.03,14.3209,0.482727,];[6641.75,14.3159,0.468336,];[6749.17,14.3109,0.454339,];[6858.33,14.3059,0.440746,];[6969.26,14.3008,0.427550,];[7081.98,14.2958,0.414725,];[7196.53,14.2907,0.402271,];[7312.93,14.2857,0.390179,];[7431.21,14.2806,0.378427,];[7551.40,14.2756,0.367020,];[7673.54,14.2706,0.355946,];[7797.65,14.2657,0.345189,];[7923.77,14.2607,0.334747,];[8051.94,14.2558,0.324605,];[8182.17,14.2510,0.314762,];[8314.51,14.2461,0.305207,];[8448.99,14.2414,0.295929,];[8585.64,14.2366,0.286926,];[8724.51,14.2319,0.278183,];[8865.62,14.2273,0.269697,];[9009.02,14.2227,0.261465,];[9154.73,14.2181,0.253469,];[9302.80,14.2136,0.245713,];[9453.27,14.2091,0.238188,];[9606.17,14.2047,0.230880,];[9761.54,14.2004,0.223790,];[9919.42,14.1961,0.216911,];[10079.9,14.1919,0.210235,];[10242.9,14.1877,0.203758,];[10408.6,14.1836,0.197474,];[10576.9,14.1795,0.191376,];[10748.0,14.1756,0.185461,];[10921.8,14.1716,0.179721,];[11098.5,14.1677,0.174154,];[11278.0,14.1639,0.168752,];[11460.4,14.1602,0.163513,];[11645.8,14.1565,0.158430,];[11834.1,14.1528,0.153500,];[12025.5,14.1492,0.148717,];[12220.0,14.1457,0.144079,];[12417.7,14.1423,0.139580,];[12618.5,14.1389,0.135216,];[12822.6,14.1355,0.130984,];[13030.0,14.1322,0.126879,];[13240.8,14.1290,0.122899,];[13454.9,14.1258,0.119038,];[13672.6,14.1227,0.115294,];[13893.7,14.1197,0.111664,];[14118.4,14.1167,0.108143,];[14346.8,14.1137,0.104730,];[14578.8,14.1108,0.101419,];[14814.6,14.1080,0.982093E-01];[15054.2,14.1052,0.950968E-01];[15297.7,14.1025,0.920790E-01];[15545.2,14.0998,0.891530E-01];[15796.6,14.0972,0.863160E-01];[16052.1,14.0946,0.835654E-01];[16311.7,14.0921,0.808987E-01];[16575.5,14.0896,0.783132E-01];[16843.6,14.0872,0.758067E-01];[17116.1,14.0848,0.733767E-01];[17392.9,14.0825,0.710210E-01];[17674.2,14.0802,0.687373E-01];[17960.1,14.0780,0.665234E-01];[18250.6,14.0758,0.643773E-01];[18545.8,14.0736,0.622970E-01];[18845.7,14.0715,0.602804E-01];[19150.5,14.0695,0.583256E-01];[19460.3,14.0675,0.564308E-01];[19775.0,14.0655,0.545942E-01];[20094.9,14.0636,0.528124E-01];[20419.9,14.0617,0.510884E-01];[20750.2,14.0598,0.494193E-01];[21085.8,14.0580,0.478034E-01];[21426.8,14.0562,0.462390E-01];[21773.4,14.0545,0.447245E-01];[22125.6,14.0528,0.432583E-01];[22483.4,14.0511,0.418390E-01];[22847.1,14.0495,0.404650E-01];[23216.6,14.0479,0.391349E-01];[23592.1,14.0463,0.378475E-01];[23973.7,14.0448,0.366013E-01];[24361.5,14.0433,0.353950E-01];[24755.5,14.0419,0.342274E-01];[25155.9,14.0405,0.330973E-01];[25562.8,14.0391,0.320035E-01];[25976.2,14.0377,0.309448E-01];[26396.4,14.0364,0.299202E-01];[26823.3,14.0351,0.289286E-01];[27257.2,14.0338,0.279690E-01];[27698.0,14.0326,0.270403E-01];[28146.0,14.0314,0.261415E-01];[28601.3,14.0302,0.252718E-01];[29063.9,14.0291,0.244301E-01];[29533.9,14.0279,0.236157E-01];[30000.0,14.0269,0.228464E-01]];
            end
            
               
           
        end
        
        function [Vertex, Faces, ColQuad] = functionWireframe(obj,widthMain, heightMain, thickness)

        Vertex(1,:)=[-thickness/2,-heightMain/2 ,-widthMain/2];
        Vertex(2,:)=[thickness/2, -heightMain/2 ,-widthMain/2];
        Vertex(3,:)=[thickness/2, heightMain/2,-widthMain/2];
        Vertex(4,:)=[-thickness/2, heightMain/2,-widthMain/2];

        Vertex(5,:)=[-thickness/2,-heightMain/2 ,widthMain/2];
        Vertex(6,:)=[thickness/2, -heightMain/2 ,widthMain/2];
        Vertex(7,:)=[thickness/2, heightMain/2,widthMain/2];
        Vertex(8,:)=[-thickness/2, heightMain/2,widthMain/2];

        Faces(1,:)=[1,2,3,4];
        CF(1)=1;
        Faces(2,:)=[1,2,6,5];
        CF(2)=2;
        Faces(3,:)=[2,3,7,6];
        CF(3)=3;
        Faces(4,:)=[3,4,8,7];
        CF(4)=4;
        Faces(5,:)=[4,1,5,8];
        CF(5)=5;
        Faces(6,:)=[5,6,7,8];
        CF(6)=6;

        for II=1:6
            switch(CF(II))

                case 1
                    ColQuad(II,:)=[0.9,0.9,0.9];
                case 2
                    ColQuad(II,:)=[0.8,0.8,0.8];
                case 3
                    ColQuad(II,:)=[0.75,0.75,0.75];
                case 4
                    ColQuad(II,:)=[0.8,0.8,0.8];
                case 5
                    ColQuad(II,:)=[0.75,0.75,0.75];
                case 6
                    ColQuad(II,:)=[0.9,0.9,0.9];
            end

        end
        end
        
        
        function MakeWireFramePlot(obj,PitchAngle,YawAngle,Reflections,Ax)
            if(nargin<5)
                figure
                Ax=axes;
                hold(Ax,'on');
            end
            AR=2;
            [Vertex, Faces, ColQuad] = obj.functionWireframe(3, 2, 0.1 );
            [UnitArrow, facesUnitArrow, ColorArrow] = obj.functionArrow([0,0,0], [0.85,0,0], 0.02,[1,0,0], 0.04,20);
            PureRotation=obj.RotationStages_deg_input(PitchAngle,YawAngle);
            FullRotation=PureRotation*obj.CrystalInHolder()*obj.InitialRotation();
            Wireframe=(PureRotation*Vertex.').';
            patch('Vertices', Wireframe, 'Faces', Faces, 'FaceColor', 'flat','FaceVertexCData',ColQuad,'edgecolor','k','FaceAlpha',0.1,'parent',Ax);
            %patch('Vertices', UnitArrow, 'Faces',facesUnitArrow, 'FaceColor', 'flat','FaceVertexCData',ColorArrow,'edgecolor','k','FaceAlpha',1,'parent',Ax);
            NormalBeamProp=obj.BeamPropagation/norm(obj.BeamPropagation);  
            FrecciaBP=FDir(obj,UnitArrow,obj.BeamPropagation,0,AR);
            patch('Vertices', FrecciaBP, 'Faces',facesUnitArrow, 'FaceColor', 'flat','FaceVertexCData',ColorArrow,'edgecolor','k','FaceAlpha',1,'parent',Ax);
            %plot3(AR*[-NormalBeamProp(1),NormalBeamProp(1)],AR*[-NormalBeamProp(2),NormalBeamProp(2)],AR*[-NormalBeamProp(3),NormalBeamProp(3)],'linewidth',2);
            RotatedReflections=FullRotation*Reflections;
            RotatedMainCut=FullRotation*obj.MainCut;
            RotatedSecondaryCut=FullRotation*obj.SecondaryCut; 
            FrecciaSC=FDir(obj,UnitArrow,RotatedSecondaryCut,1,1);
            FrecciaMC=FDir(obj,UnitArrow,RotatedMainCut,1,1);
            FrecciaH=FDir(obj,UnitArrow,RotatedReflections,1,1);
            patch('Vertices', FrecciaSC, 'Faces',facesUnitArrow, 'FaceColor', 'flat','FaceVertexCData',ColorArrow,'edgecolor','g','FaceAlpha',1,'parent',Ax);
            patch('Vertices', FrecciaMC, 'Faces',facesUnitArrow, 'FaceColor', 'flat','FaceVertexCData',ColorArrow,'edgecolor','b','FaceAlpha',1,'parent',Ax);
            patch('Vertices', FrecciaH, 'Faces',facesUnitArrow, 'FaceColor', 'flat','FaceVertexCData',ColorArrow,'edgecolor','r','FaceAlpha',1,'parent',Ax);
            
            
            [UnitCP, UnitCPFaces] = obj.UnitCircularPatch(20);
            AllCP=obj.PlaneArray(UnitCP,RotatedReflections,1,5,0.05);
            for JJ=1:5
                patch('Vertices', AllCP{JJ}, 'Faces',UnitCPFaces, 'FaceColor', 'flat','FaceVertexCData',[1,0,0],'edgecolor','r','FaceAlpha',0.1,'parent',Ax);
            end
        end
        
        function [Vertex, Faces] = UnitCircularPatch(obj,steps)
            t=linspace(0,2*pi,steps);
            Vertex=[0*t.',cos(t.'),sin(t.')];
            Faces=1:steps;
        end
        
        function [versor1,versor2]= orthogonalBase(obj,Vector)
            vprova=Vector; vprova(1)=vprova(1)+1;
            V1=cross(vprova,Vector);
            versor1=V1/norm(V1);
            V2=cross(versor1,Vector);
            versor2=V2/norm(V2);
            if(dot(Vector,cross(versor1,versor2))<0)
               VT=versor1;
               versor1=versor2;
               versor2=VT;
            end
        end
        
        function [Vertex, Faces] = CircularPatch(obj,versor1,versor2,radius,steps)
            t=linspace(0,2*pi,steps);
            for II=1:steps
                Vertex(II,:)=radius*versor1*cos(t) + radius*versor2*sin(t);
            end
            Faces=1:steps;
        end
        
        function AllCP=PlaneArray(obj,UnitCP,Vector,Scale,Quante,Spacing)
            UnitCP=UnitCP*Scale;
            MAT=obj.Rot_vector_onto_vector([1,0,0],Vector/norm(Vector));
            if(~mod(Quante,2)), Quante=Quante+1; end
            UnitCP=(MAT*UnitCP.').';
            Offsets=Spacing*((0:Quante) - (Quante/2));
            for II=1:length(Offsets)
               AllCP{II}=UnitCP+ ones(size(UnitCP,1),1)*(Vector.'/norm(Vector)*Offsets(II));
            end
        end
            
        function Freccia=FDir(obj,Arrow,Vector,Offset,Length)
            
            if(Offset==1)%ok as it is, arrow matching vector and exiting from origin
            elseif(Offset==-1)
                Arrow(:,1)=1-Arrow(:,1);
            elseif(Offset==0)
                Arrow(:,1)=Arrow(:,1)-0.5;
            end
            Arrow(:,1)=Arrow(:,1)*Length;
            MAT=obj.Rot_vector_onto_vector([1,0,0],Vector/norm(Vector));
            Freccia=(MAT*Arrow.').';
        end
        
        function [my_verticesARROW, my_facesARROW, ColorARROW] = functionArrow(obj,Bend, Btip, BBR,CONETIP, CONEBR,LINES)
            [my_verticesCYLINDER, my_facesCYLINDER, ~] = obj.functionCYLINDER(Bend, Btip, BBR, LINES);
            [my_verticesCONE, my_facesCONE, ~] = obj.functionCONE(Btip, CONETIP, CONEBR,LINES);
            %save temp
            Color(1,:)=[1,1,0];
            Color(2,:)=[1,1,0];
            [SA,SB]=size(my_facesCYLINDER);
            my_facesCONE=my_facesCONE+numel(my_verticesCYLINDER)/3;
            CN=[linspace(1,0.9,SA-2).',linspace(1,0.9,SA-2).',linspace(0,0,SA-2).'];
            Color=[Color;CN];
            Color=[Color;1,1,0];
            [SA,SB]=size(my_verticesCONE);
            CN=[linspace(1,0.9,SA-1).',linspace(1,0.9,SA-1).',linspace(0,0,SA-1).'];
            Color=[Color;CN];
            my_verticesARROW=[my_verticesCYLINDER;my_verticesCONE];
            ColorARROW=Color;
            my_facesARROW=[my_facesCYLINDER;my_facesCONE];
        end
        
        function [my_verticesCONE, my_facesCONE, GREYBLOCKS] = functionCONE(obj,CONEEND, CONETIP, CONEBASERADIUS,CONELINES)
            
            CONEDIRECTION=CONEEND-CONETIP;
            IND=find(CONEDIRECTION~=0,1,'first');
            CONEDIRECTION=CONEDIRECTION/norm(CONEDIRECTION);
            if(IND==1)
                if(CONEDIRECTION(3))
                    CONEV2=[0,1,CONEDIRECTION(2)/CONEDIRECTION(3)] ;
                else
                    CONEV2=[0,0,1];
                end
            elseif(IND==2)
                if(CONEDIRECTION(1))
                    CONEV2=[0,1,CONEDIRECTION(3)/CONEDIRECTION(1)] ;
                else
                    CONEV2=[1,0,0];
                end
            else
                if(CONEDIRECTION(2))
                    CONEV2=[0,1,CONEDIRECTION(1)/CONEDIRECTION(2)] ;
                else
                    CONEV2=[0,1,0];
                end
            end
            CONEV2=CONEV2/norm(CONEV2);
            CONEV1=CONEDIRECTION;
            CONEV3=cross(CONEV2,CONEV1)/norm(cross(CONEV2,CONEV1));
            
            BASE=linspace(0,2*pi,CONELINES);%(cos(linspace(0,2*pi,CONELINES))*CONEV2 + sin(linspace(0,2*pi,CONELINES))*CONEV2)*CONEBASERADIUS;
            
            for II=1:CONELINES
                my_verticesCONE(II,:)= cos(BASE(II))*CONEBASERADIUS*CONEV2+sin(BASE(II))*CONEBASERADIUS*CONEV3+CONEEND;
            end
            my_verticesCONE(end+1,:) = CONETIP;
            my_facesCONE =[1:CONELINES].';
            my_facesCONE(:,2)=my_facesCONE+1; my_facesCONE(end,2)=1;
            my_facesCONE(:,3)=CONELINES+1;
            
            [SA,SB]=size(my_facesCONE);
            
            GREYBLOCKS=ones(SA,3)*0.5;
            
            %GREYBLOCKS=rand(size(GREYBLOCKS))
            
            my_facesCONE(:,4:CONELINES)=NaN;
            my_facesCONE(end+1,:)=1:CONELINES;
            
            GREYBLOCKS(end+1,:)=[0.2,0.2,0.2];
        end
        
        function [my_verticesCYLINDER, my_facesCYLINDER, GREYBLOCKS] = functionCYLINDER(obj,CYLINDEREND, CYLINDERTIP, CYLINDERBASERADIUS,CYLINDERLINES)
            
            CYLINDERDIRECTION=CYLINDEREND-CYLINDERTIP;
            IND=find(CYLINDERDIRECTION~=0,1,'first');
            CYLINDERDIRECTION=CYLINDERDIRECTION/norm(CYLINDERDIRECTION);
            if(IND==1)
                if(CYLINDERDIRECTION(3))
                    CYLINDERV2=[0,1,CYLINDERDIRECTION(2)/CYLINDERDIRECTION(3)] ;
                else
                    CYLINDERV2=[0,0,1];
                end
            elseif(IND==2)
                if(CYLINDERDIRECTION(1))
                    CYLINDERV2=[0,1,CYLINDERDIRECTION(3)/CYLINDERDIRECTION(1)] ;
                else
                    CYLINDERV2=[1,0,0];
                end
            else
                if(CYLINDERDIRECTION(2))
                    CYLINDERV2=[0,1,CYLINDERDIRECTION(1)/CYLINDERDIRECTION(2)] ;
                else
                    CYLINDERV2=[0,1,0];
                end
            end
            CYLINDERV2=CYLINDERV2/norm(CYLINDERV2);
            CYLINDERV1=CYLINDERDIRECTION;
            CYLINDERV3=cross(CYLINDERV2,CYLINDERV1)/norm(cross(CYLINDERV2,CYLINDERV1));
            
            BASE=linspace(0,2*pi,CYLINDERLINES);%(cos(linspace(0,2*pi,CYLINDERLINES))*CYLINDERV2 + sin(linspace(0,2*pi,CYLINDERLINES))*CYLINDERV2)*CYLINDERBASERADIUS;
            if(exist('my_verticesCYLINDER'))
                clear my_verticesCYLINDER
            end
            
            for II=1:CYLINDERLINES
                my_verticesCYLINDER(II,:)= cos(BASE(II))*CYLINDERBASERADIUS*CYLINDERV2+sin(BASE(II))*CYLINDERBASERADIUS*CYLINDERV3+CYLINDERTIP;
            end
            for II=1:CYLINDERLINES
                my_verticesCYLINDER(II+CYLINDERLINES,:)= cos(BASE(II))*CYLINDERBASERADIUS*CYLINDERV2+sin(BASE(II))*CYLINDERBASERADIUS*CYLINDERV3+CYLINDEREND;
            end
            
            my_facesCYLINDER=[1:CYLINDERLINES];
            my_facesCYLINDER(2,:)=[(CYLINDERLINES+1):(2*CYLINDERLINES)];
            
            for HH=1:(CYLINDERLINES-1)
                my_facesCYLINDER(HH+2,:)=NaN;
                my_facesCYLINDER(HH+2,1)=HH;
                my_facesCYLINDER(HH+2,2)=HH+1;
                my_facesCYLINDER(HH+2,3)=HH+1+CYLINDERLINES;
                my_facesCYLINDER(HH+2,4)=HH+CYLINDERLINES;
            end
            
            try
                clear GREYBLOCKS
            end
            
            ADDS=1;
            
            GREYBLOCKS=[0.45,0.45,0.45;0.25,0.25,0.25];
            GREYBLOCKS(3:(CYLINDERLINES+ADDS),:)=ones(1,length(3:(CYLINDERLINES+ADDS))).'*[0.35,0.35,0.35];
        end
        
    end
    
end