function DailyBCSChecker
% Performs daily BCS checks at the click of a button. It's very important
% that this script stay up to date as the BCS checklists evolve over time.
% To that end, I have kept it very simple. Anyone with basic Matlab
% knowledge should be able to go in and update it.
%
% B. Ripman 2016.

clear
clc

% Remember to correct these dates whenever you update the script!
lcls_date = '1/27/2016';
esa_date = '9/27/2016';
disp('Beginning BCS checks.');
disp('Remember to confirm that this script is up to date for each area!');
doLCLSChecks(lcls_date);
doESAChecks(esa_date);

end

function doLCLSChecks(lcls_date)
% Super basic function that goes down a list of LCLS BCS items and
% checks whether each one is in the correct state. Data format for each
% item is { <label> ; <PV> ; <expected value> }.

fprintf('\nNow performing LCLS checks using the %s checklist...\n', lcls_date);
problem_found = 0;

bcs_items = {
    {'BSY --> R119B PICs --> CH01: IC10B (D10)' ; 'MC00:MISC:22:IC10BBYP'; '2'}; ...
    {'BSY --> R119B PICs --> CH04: IC65 (ST60)' ; 'MC00:MISC:22:IC65BYP' ; '2'}; ...
    {'BSY --> R119B PICs --> CH05: IC66 (ST61)' ; 'MC00:MISC:22:IC66BYP' ; '2'}; ...
    {'BSY --> R119B PICs --> CH08: IC104A (D2)' ; 'MC00:MISC:22:IC104ABY'; '2'}; ...
    {'BSY --> R119C PICs --> CH07: IC104C (D2)' ; 'MC00:MISC:23:IC104CBY'; '2'}; ...
    {'BSY --> R119C PICs --> CH08: IC90B (PC90)'; 'MC00:MISC:23:IC90BBYP'; '2'}; ...
    {'BSY --> R119C PICs --> CH10: IC10A (D10)' ; 'MC00:MISC:23:IC10ABYP'; '2'}; ...
    {'BSY --> R119D PICs --> CH05: IC90A (PC90)'; 'MC00:MISC:23:IC90ABYP'; '2'}; ...
    {'BSY --> R119D PICs --> CH07: IC104B (D2)' ; 'MC00:MISC:23:IC104BBY'; '2'}; ...
    {'BSY --> R119D PICs --> CH10: IC10C (D10)' ; 'MC00:MISC:23:IC10CBYP'; '2'}; ...
    {'BSY --> Digital Summary Chassis 1 --> CH01: R119B SUM1'; 'BCS:BSY0:1:R119BSUM1MODE'; 'ACTIVE'}; ...
    {'BSY --> Digital Summary Chassis 1 --> CH02: R119B SUM2'; 'BCS:BSY0:1:R119BSUM2MODE'; 'ACTIVE'}; ...
    {'BSY --> Digital Summary Chassis 1 --> CH03: R119C SUM1'; 'BCS:BSY0:1:R119CSUM1MODE'; 'ACTIVE'}; ...
    {'BSY --> Digital Summary Chassis 1 --> CH04: R119C SUM2'; 'BCS:BSY0:1:R119CSUM2MODE'; 'ACTIVE'}; ...
    {'BSY --> Digital Summary Chassis 1 --> CH05: R119D SUM1'; 'BCS:BSY0:1:R119DSUM1MODE'; 'ACTIVE'}; ...
    {'BSY --> Digital Summary Chassis 1 --> CH06: R119D SUM2'; 'BCS:BSY0:1:R119DSUM2MODE'; 'ACTIVE'}; ...
    {'BSY --> Digital Summary Chassis 1 --> CH07: IC22B IC29A'; 'BCS:BSY0:1:IC22B29AMODE'; 'ACTIVE'}; ...
    {'BSY --> Digital Summary Chassis 1 --> CH08: IC22A IC29B'; 'BCS:BSY0:1:IC22A29BMODE'; 'ACTIVE'}; ...
    {'BSY --> Digital Summary Chassis 1 --> Summary Interlock 1'; 'BCS:BSY0:1:DSC2ILK1'; 'OK'}; ...
    {'BSY --> Digital Summary Chassis 1 --> Summary Interlock 2'; 'BCS:BSY0:1:DSC2ILK2'; 'OK'}; ...
    {'BSY --> Digital Summary Chassis 2 --> CH01: D2 FS1'; 'BCS:BSY0:1:D2FS1MODE'; 'ACTIVE'}; ...
    {'BSY --> Digital Summary Chassis 2 --> CH02: D2 FS2'; 'BCS:BSY0:1:D2FS2MODE'; 'ACTIVE'}; ...
    {'BSY --> Digital Summary Chassis 2 --> CH05: D10 FS1'; 'BCS:BSY0:1:D10FS1MODE'; 'ACTIVE'}; ...
    {'BSY --> Digital Summary Chassis 2 --> CH06: D10 FS2'; 'BCS:BSY0:1:D10FS2MODE'; 'ACTIVE'}; ...
    {'BSY --> Digital Summary Chassis 2 --> Summary Interlock 1'; 'BCS:BSY0:1:DSC1ILK1'; 'OK'}; ...
    {'BSY --> Digital Summary Chassis 2 --> Summary Interlock 2'; 'BCS:BSY0:1:DSC1ILK2'; 'OK'}; ...
    {'LI28 --> PIC Chassis --> IC 951 Status'   ; 'PICS:LI28:951:BCSMODE'; 'ACTIVE'}; ...
    {'LI28 --> PIC Chassis --> IC 961 Status'   ; 'PICS:LI28:961:BCSMODE'; 'ACTIVE'}; ...
    {'LI24 --> Summary Chassis --> PIC Summary #1'      ; 'BCS:LI24:1:PICSUM1MODE' ; 'ACTIVE'}; ...
    {'LI24 --> Summary Chassis --> PIC Summary #2'      ; 'BCS:LI24:1:PICSUM2MODE' ; 'ACTIVE'}; ...
    {'LI24 --> Summary Chassis --> LION Gas Pressure #1'; 'BCS:LI24:1:LIONPSW1MODE'; 'ACTIVE'}; ...
    {'LI24 --> Summary Chassis --> LION Gas Pressure #2'; 'BCS:LI24:1:LIONPSW2MODE'; 'ACTIVE'}; ...
    {'LI24 --> PIC Chassis --> CH01: BC2LION-1N'        ; 'LION:LI24:708:BCSMODE'  ; 'ACTIVE'}; ...
    {'LI24 --> PIC Chassis --> CH02: BC2LION-1S'        ; 'LION:LI24:709:BCSMODE'  ; 'ACTIVE'}; ...
    {'LCLS Injector --> Summary Chassis --> CH01: PIC Summary #1'  ; 'BCS:IN20:1:PICSUM1MODE'   ; 'ACTIVE'}; ...
    {'LCLS Injector --> Summary Chassis --> CH02: PIC Summary #2'  ; 'BCS:IN20:1:PICSUM2MODE'   ; 'ACTIVE'}; ...
    {'LCLS Injector --> Summary Chassis --> CH03: Dump Flow Switch'; 'DUMP:IN20:999:BCSFSW1MODE'; 'ACTIVE'}; ...
    {'LCLS Injector --> Summary Chassis --> CH04: Dump Flow Switch'; 'DUMP:IN20:999:BCSFSW2MODE'; 'ACTIVE'}; ...
    {'LCLS Injector --> Summary Chassis --> CH05: LION Gas Pres #1'; 'BCS:IN20:1:LIONPSW1MODE'  ; 'ACTIVE'}; ...
    {'LCLS Injector --> Summary Chassis --> CH06: LION Gas Pres #2'; 'BCS:IN20:1:LIONPSW2MODE'  ; 'ACTIVE'}; ...
    {'LCLS Injector --> PIC Chassis --> INJLION-1N'        ; 'LION:IN20:650:BCSMODE'  ; 'ACTIVE'}; ...
    {'LCLS Injector --> PIC Chassis --> INJLION-1S'        ; 'LION:IN20:651:BCSMODE'  ; 'ACTIVE'}; ...
    {'LCLS Injector --> PIC Chassis --> BC1LION-1N'        ; 'LION:LI21:162:BCSMODE'  ; 'ACTIVE'}; ...
    {'LCLS Injector --> PIC Chassis --> BC1LION-1S'        ; 'LION:LI21:163:BCSMODE'  ; 'ACTIVE'}; ...
    {'B911 --> Summary Chassis 1 --> CH01: PIC Summary #1' ; 'BCS:LTU1:1:911PICS1MODE'; 'ACTIVE'}; ...
    {'B911 --> Summary Chassis 1 --> CH02: PIC Summary #2' ; 'BCS:LTU1:1:911PICS2MODE'; 'ACTIVE'}; ...
    {'B911 --> Summary Chassis 1 --> CH07: BTHW Summary #1'; 'BCS:LTU1:1:BTHWSUM1MODE'; 'ACTIVE'}; ...
    {'B911 --> Summary Chassis 1 --> CH08: BTHW Summary #2'; 'BCS:LTU1:1:BTHWSUM2MODE'; 'ACTIVE'}; ...
    {'B911 --> Summary Chassis 2 --> CH01: PIC Summary #1' ; 'BCS:LTU1:1:911PICS3MODE'; 'ACTIVE'}; ...
    {'B911 --> Summary Chassis 2 --> CH02: PIC Summary #2' ; 'BCS:LTU1:1:911PICS4MODE'; 'ACTIVE'}; ...
    {'B911 --> Summary Chassis 2 --> CH03: DTC1 Summary #1'; 'DTC:LTU1:1:911DTC1MODE' ; 'ACTIVE'}; ...
    {'B911 --> Summary Chassis 2 --> CH04: DTC1 Summary #2'; 'DTC:LTU1:1:911DTC2MODE' ; 'ACTIVE'}; ...
    {'B911 --> Summary Chassis 2 --> CH05: DTC2 Summary #1'; 'DTC:LTU1:2:911DTC1MODE' ; 'ACTIVE'}; ...
    {'B911 --> Summary Chassis 2 --> CH06: DTC2 Summary #2'; 'DTC:LTU1:2:911DTC2MODE' ; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 1 --> CH01: LTU LION-1N'; 'LION:LTU1:404:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 1 --> CH02: LTU LION-1S'; 'LION:LTU1:405:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 1 --> CH03: LTU LION-2N'; 'LION:LTU1:504:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 1 --> CH04: LTU LION-2S'; 'LION:LTU1:505:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 1 --> CH05: LTU LION-3N'; 'LION:LTU1:584:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 1 --> CH06: LTU LION-3S'; 'LION:LTU1:585:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 2 --> CH01: BTM 1-IC1'  ; 'PICS:LTU1:156:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 2 --> CH02: BTM 1-IC2'  ; 'PICS:LTU1:157:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 2 --> CH03: BTM 2-IC1'  ; 'PICS:LTU1:222:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 2 --> CH04: BTM 2-IC2'  ; 'PICS:LTU1:223:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 2 --> CH05: BTM 3-IC1'  ; 'PICS:LTU1:296:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 2 --> CH06: BTM 3-IC2'  ; 'PICS:LTU1:297:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 2 --> CH07: BTM 4-IC1'  ; 'PICS:LTU1:426:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 2 --> CH08: BTM 4-IC2'  ; 'PICS:LTU1:427:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 2 --> CH09: TDUND-IC1'  ; 'PICS:LTU1:970:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> PIC Chassis 2 --> CH10: TDUND-IC2'  ; 'PICS:LTU1:971:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> Dual Trip Comparator 1 --> CH01: BYD #1 (active/inactive)' ; 'DTC:LTU1:11:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> Dual Trip Comparator 1 --> CH02: BYD #2 (active/inactive)' ; 'DTC:LTU1:12:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> Dual Trip Comparator 1 --> CH03: BX31 #1 (active/inactive)'; 'DTC:LTU1:13:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> Dual Trip Comparator 1 --> CH04: BX31 #2 (active/inactive)'; 'DTC:LTU1:14:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> Dual Trip Comparator 2 --> CH01: BX32 #1 (active/inactive)'; 'DTC:LTU1:21:BCSMODE'; 'ACTIVE'}; ...
    {'B911 --> Dual Trip Comparator 2 --> CH02: BX32 #2 (active/inactive)'; 'DTC:LTU1:22:BCSMODE'; 'ACTIVE'}; ...
    {'B913 --> Digital Summary Chassis --> CH01: PIC SUM #1'          ; 'BCS:LTU1:1:913PICS1MODE'; 'ACTIVE'}; ...
    {'B913 --> Digital Summary Chassis --> CH02: PIC SUM #2'          ; 'BCS:LTU1:1:913PICS2MODE'; 'ACTIVE'}; ...
    {'B913 --> Digital Summary Chassis --> CH03: LION GAS PSW #1'     ; 'BCS:LTU1:1:LIONPS1MODE' ; 'ACTIVE'}; ...
    {'B913 --> Digital Summary Chassis --> CH04: LION GAS PSW #2'     ; 'BCS:LTU1:1:LIONPS2MODE' ; 'ACTIVE'}; ...
    {'B913 --> Digital Summary Chassis --> CH05: PIC GAS PSW #1'      ; 'BCS:LTU1:1:PIC_PS1MODE' ; 'ACTIVE'}; ...
    {'B913 --> Digital Summary Chassis --> CH06: PIC GAS PSW #2'      ; 'BCS:LTU1:1:PIC_PS2MODE' ; 'ACTIVE'}; ...
    {'B913 --> Digital Summary Chassis --> CH07: Photon ST1/2 Chain A'; 'BCS:LTU1:1:ST1ST2AMODE' ; 'ACTIVE'}; ...
    {'B913 --> Digital Summary Chassis --> CH08: Photon ST1/2 Chain B'; 'BCS:LTU1:1:ST1ST2BMODE' ; 'ACTIVE'}; ...
    {'B913 --> Digital Summary Chassis --> CH09: S2C OUT #1'          ; 'BCS:LTU1:1:S2COUT1MODE' ; 'ACTIVE'}; ...
    {'B913 --> Digital Summary Chassis --> CH10: S2C OUT #2'          ; 'BCS:LTU1:1:S2COUT2MODE' ; 'ACTIVE'}; ...
    {'B913 --> PIC Chassis 1 --> CH01: LTU LION-4N'; 'LION:LTU1:716:BCSMODE'; 'ACTIVE'}; ...
    {'B913 --> PIC Chassis 1 --> CH02: LTU LION-4S'; 'LION:LTU1:717:BCSMODE'; 'ACTIVE'}; ...
    {'B913 --> PIC Chassis 1 --> CH03: LTU LION-5N'; 'LION:LTU1:732:BCSMODE'; 'ACTIVE'}; ...
    {'B913 --> PIC Chassis 1 --> CH04: LTU LION-5S'; 'LION:LTU1:733:BCSMODE'; 'ACTIVE'}; ...
    {'B913 --> PIC Chassis 1 --> CH05: LTU LION-6N'; 'LION:LTU1:752:BCSMODE'; 'ACTIVE'}; ...
    {'B913 --> PIC Chassis 1 --> CH06: LTU LION-6S'; 'LION:LTU1:753:BCSMODE'; 'ACTIVE'}; ...
    {'B913 --> PIC Chassis 1 --> CH07: LTU LION-7N'; 'LION:LTU1:765:BCSMODE'; 'ACTIVE'}; ...
    {'B913 --> PIC Chassis 1 --> CH08: LTU LION-7S'; 'LION:LTU1:766:BCSMODE'; 'ACTIVE'}; ...
    {'B913 --> PIC Chassis 1 --> CH09: SXRSS - IC1'; 'PICS:LTU1:551:BCSMODE'; 'ACTIVE'}; ...
    {'B913 --> PIC Chassis 1 --> CH10: SXRSS - IC2'; 'PICS:LTU1:552:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> Digital Summary Chassis --> CH:09: PIC SUM1'; 'BCS:DMP1:1:PICSUM1MODE'; 'ACTIVE'}; ...
    {'B921 --> Digital Summary Chassis --> CH:10: PIC SUM2'; 'BCS:DMP1:1:PICSUM2MODE'; 'ACTIVE'}; ...
    {'B921 --> Digital Summary Chassis --> CH:11: EDMP FS1'; 'BCS:DMP1:1:EDMP_FS1MODE'; 'ACTIVE'}; ...
    {'B921 --> Digital Summary Chassis --> CH:12: EDMP FS2'; 'BCS:DMP1:1:EDMP_FS2MODE'; 'ACTIVE'}; ...
    {'B921 --> Digital Summary Chassis --> CH:13: FEE ST1 FS1'; 'BCS:DMP1:1:FEE_FS1MODE'; 'ACTIVE'}; ...
    {'B921 --> Digital Summary Chassis --> CH:14: FEE ST1 FS2'; 'BCS:DMP1:1:FEE_FS2MODE'; 'ACTIVE'}; ...
    {'B921 --> B921 e- DUMP PIC Chassis --> CH01: PCPM0 IC-1' ; 'PICS:DMP1:310:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 e- DUMP PIC Chassis --> CH02: PCPM0 IC-2' ; 'PICS:DMP1:311:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 e- DUMP PIC Chassis --> CH03: PCPM1 IC-1' ; 'PICS:DMP1:710:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 e- DUMP PIC Chassis --> CH04: PCPM1 IC-2' ; 'PICS:DMP1:711:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 e- DUMP PIC Chassis --> CH05: PCPM2 IC-1' ; 'PICS:DMP1:800:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 e- DUMP PIC Chassis --> CH06: PCPM2 IC-2' ; 'PICS:DMP1:801:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 e- DUMP PIC Chassis --> CH07: BYD IC-1'   ; 'PICS:DMP1:400:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 e- DUMP PIC Chassis --> CH08: BYD IC-2'   ; 'PICS:DMP1:401:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 e- DUMP PIC Chassis --> CH09: BTMQUE IC-1'; 'PICS:DMP1:312:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 e- DUMP PIC Chassis --> CH10: BTMQUE IC-2'; 'PICS:DMP1:313:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 FEE PIC Chassis --> CH01: FEE ST1 IC-1'   ; 'PICS:DMP1:718:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 FEE PIC Chassis --> CH02: FEE ST1 IC-2'   ; 'PICS:DMP1:719:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 FEE PIC Chassis --> CH03: FEE ST2 IC-1'   ; 'PICS:DMP1:996:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 FEE PIC Chassis --> CH04: FEE ST2 IC-2'   ; 'PICS:DMP1:995:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 FEE PIC Chassis --> CH05: SDMP IC-1'; 'PICS:DMP1:997:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 FEE PIC Chassis --> CH06: SDMP IC-2'; 'PICS:DMP1:998:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 FEE PIC Chassis --> CH07: C1 IC-1'  ; 'PICS:FEE1:100:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 FEE PIC Chassis --> CH08: C1 IC-2'  ; 'PICS:FEE1:101:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 FEE PIC Chassis --> CH09: C2H IC-1' ; 'PICS:FEE1:150:BCSMODE'; 'ACTIVE'}; ...
    {'B921 --> B921 FEE PIC Chassis --> CH10: C2H IC-2' ; 'PICS:FEE1:151:BCSMODE'; 'ACTIVE'} ...
    };

for i = 1:length(bcs_items)
    val = lcaGetSmart(bcs_items{i}{2});
    expected_val = bcs_items{i}{3};
    if ~strcmpi(val, expected_val)
       problem_found = 1;
       fprintf('Problem found in %s\n', bcs_items{i}{1});
    end
end

% Can use this to check for duplicate PVs if you're into that:
% for i = 1:length(bcs_items)
%     pv = bcs_items{i}{2};
%     for j = 1:length(bcs_items)
%        if (i ~= j) && strcmpi(pv, bcs_items{j}{2})
%            disp('Duplicate PV found!');
%        end
%     end
% end

% Special handling for LI28 BCS items that are bypassd with stoppers 950 &
% 960 out.
bcs_items = {
    {'LI28 --> Summary Chassis --> PIC Summary 1'  ; 'BCS:LI28:1:PICSUM1MODE'   ; 'ACTIVE'}; ...
    {'LI28 --> Summary Chassis --> PIC Summary 2'  ; 'BCS:LI28:1:PICSUM2MODE'   ; 'ACTIVE'}; ...
    {'LI28 --> Summary Chassis --> ST950 Flwswch 1'; 'STPR:LI28:950:BCSFSW1MODE'; 'ACTIVE'}; ...
    {'LI28 --> Summary Chassis --> ST950 Flwswch 2'; 'STPR:LI28:950:BCSFSW2MODE'; 'ACTIVE'}; ...
    {'LI28 --> Summary Chassis --> ST960 Flwswch 1'; 'STPR:LI28:960:BCSFSW1MODE'; 'ACTIVE'}; ...
    {'LI28 --> Summary Chassis --> ST960 Flwswch 2'; 'STPR:LI28:960:BCSFSW2MODE'; 'ACTIVE'} ...
    };

stoppers_out = strcmpi(lcaGetSmart('STPR:LI28:960:SUM_IN'), 'NOT_IN');
for i = 1:length(bcs_items)
    val = lcaGetSmart(bcs_items{i}{2});
    expected_val = bcs_items{i}{3};
    if ~strcmpi(val, expected_val) && ~(strcmpi(val, 'BYPASS') && stoppers_out)
        problem_found = 1;
        fprintf('Problem found in %s\n', bcs_items{i}{1});
    end
end

% Special handling to check the voltage settings of the B911 DTCs.
bcs_items = {
    {'B911 --> Dual Trip Comparator 1 --> CH01: BYD #1 (low trip)'  ; 'DTC:LTU1:11:LO_IACT'; 0.755}; ...
    {'B911 --> Dual Trip Comparator 1 --> CH01: BYD #1 (high trip)' ; 'DTC:LTU1:11:HI_IACT'; 5.893}; ...
    {'B911 --> Dual Trip Comparator 1 --> CH02: BYD #2 (low trip)'  ; 'DTC:LTU1:12:LO_IACT'; 0.753}; ...
    {'B911 --> Dual Trip Comparator 1 --> CH02: BYD #2 (high trip)' ; 'DTC:LTU1:12:HI_IACT'; 5.861}; ...
    {'B911 --> Dual Trip Comparator 1 --> CH03: BX31 #1 (low trip)' ; 'DTC:LTU1:13:LO_IACT'; 0}; ...
    {'B911 --> Dual Trip Comparator 1 --> CH03: BX31 #1 (high trip)'; 'DTC:LTU1:13:HI_IACT'; 4.8}; ...
    {'B911 --> Dual Trip Comparator 1 --> CH04: BX31 #2 (low trip)' ; 'DTC:LTU1:14:LO_IACT'; 0}; ...
    {'B911 --> Dual Trip Comparator 1 --> CH04: BX31 #2 (high trip)'; 'DTC:LTU1:14:HI_IACT'; 4.8}; ...
    {'B911 --> Dual Trip Comparator 2 --> CH01: BX32 #1 (low trip)' ; 'DTC:LTU1:21:LO_IACT'; 0}; ...
    {'B911 --> Dual Trip Comparator 2 --> CH01: BX32 #1 (high trip)'; 'DTC:LTU1:21:HI_IACT'; 4.8}; ...
    {'B911 --> Dual Trip Comparator 2 --> CH02: BX32 #2 (low trip)' ; 'DTC:LTU1:22:LO_IACT'; 0}; ...
    {'B911 --> Dual Trip Comparator 2 --> CH02: BX32 #2 (high trip)'; 'DTC:LTU1:22:HI_IACT'; 4.8} ...
    };

tol = 0.01;
for i = 1:length(bcs_items)
    val = lcaGetSmart(bcs_items{i}{2});
    expected_val = bcs_items{i}{3};
    if abs(val - expected_val) > tol
        problem_found = 1;
        fprintf('Problem found in %s\n', bcs_items{i}{1});
    end
end

disp('LCLS checks complete.');
if ~problem_found, disp('No problems found!'), end

end

function doESAChecks(esa_date)
% Super basic function that goes down a list of ESA BCS items and
% checks whether each one is in the correct state. Data format for each
% item is { <label> ; <PV> ; <expected value> }.

fprintf('\nNow performing ESA checks using the %s checklist...\n', esa_date);
problem_found = 0;

bcs_items = {
    {'BSY --> R119B PICs --> CH02: IC31 (ST30)' ; 'MC00:MISC:22:IC31BYP' ; '2'}; ...
    {'BSY --> R119B PICs --> CH06: IC29A (ST29)'; 'MC00:MISC:22:IC29ABYP'; '2'}; ...
    {'BSY --> R119B PICs --> CH09: IC22B (ST22)'; 'MC00:MISC:22:IC22BBYP'; '2'}; ...
    {'BSY --> R119B PICs --> CH10: IC14 (PC14)' ; 'MC00:MISC:22:IC14BYP' ; '2'}; ...
    {'BSY --> R119C PICs --> CH09: IC12 (PC12)' ; 'MC00:MISC:23:IC12BYP' ; '2'}; ...
    {'BSY --> R119D PICs --> CH08: IC29B (ST29)'; 'MC00:MISC:23:IC29BBYP'; '2'}; ...
    {'BSY --> R119D PICs --> CH09: IC22A (ST22)'; 'MC00:MISC:23:IC22ABYP'; '2'}; ...
    {'BSY --> DSC2 --> CH07: IC22B IC29A'  ; 'BCS:BSY0:1:IC22B29AMODE'; 'ACTIVE'}; ...
    {'BSY --> DSC2 --> CH08: IC22A IC29B'  ; 'BCS:BSY0:1:IC22A29BMODE'; 'ACTIVE'}; ...
    {'BSY --> DSC2 --> Summary Interlock 1'; 'BCS:BSY0:1:DSC2ILK1'    ; 'OK'}; ...
    {'BSY --> DSC2 --> Summary Interlock 2'; 'BCS:BSY0:1:DSC2ILK2'    ; 'OK'}; ...
    {'BSY --> DSC1 --> Summary Interlock 1'; 'BCS:BSY0:1:DSC1ILK1'    ; 'OK'}; ...
    {'BSY --> DSC1 --> Summary Interlock 2'; 'BCS:BSY0:1:DSC1ILK2'    ; 'OK'}; ...
    {'ESA --> Summary Chassis --> CH01: PIC Summary 1'   ; 'AB01:BCS:3:ICSUM1BY'; '2'}; ...
    {'ESA --> Summary Chassis --> CH02: PIC Summary 2'   ; 'AB01:BCS:3:ICSUM2BY'; '2'}; ...
    {'ESA --> Summary Chassis --> CH03: IC Gas Press Sw1'; 'AB01:BCS:3:IGSPS1BY'; '2'}; ...
    {'ESA --> Summary Chassis --> CH04: IC Gas Press Sw2'; 'AB01:BCS:3:IGSPS2BY'; '2'}; ...
    {'ESA --> Summary Chassis --> CH05: 3DMP Flow Switch'; 'AB01:BCS:3:DMPFS1BY'; '2'}; ...
    {'ESA --> Summary Chassis --> CH06: 3DMP Flow Switch'; 'AB01:BCS:3:DMPFS2BY'; '2'}; ...
    {'ESA --> PIC Chassis --> CH01: 3C1-IC1' ; 'AB01:BCS:2:3C1IC1BY'; '1'}; ...
    {'ESA --> PIC Chassis --> CH02: 3C1-IC2' ; 'AB01:BCS:2:3C1IC2BY'; '1'}; ...
    {'ESA --> PIC Chassis --> CH03: 3C2-IC1' ; 'AB01:BCS:2:3C2IC1BY'; '1'}; ...
    {'ESA --> PIC Chassis --> CH04: 3C2-IC2' ; 'AB01:BCS:2:3C2IC2BY'; '1'}; ...
    {'ESA --> PIC Chassis --> CH07: 3DMP-IC1'; 'AB01:BCS:2:DMPIC1BY'; '1'}; ...
    {'ESA --> PIC Chassis --> CH08: 3DMP-IC2'; 'AB01:BCS:2:DMPIC2BY'; '1'}; ...    
    {'ESA --> PIC Chassis --> CH05: 3LION-1N'; 'AB01:BCS:2:SPRIC1BY'; '1'}; ...
    {'ESA --> PIC Chassis --> CH06: 3LION-1S'; 'AB01:BCS:2:SPRIC2BY'; '1'}; ...
    {'ESA --> PIC Chassis --> CH09: 3LION-2A'; 'AB01:BCS:2:3LION1BY'; '1'}; ...
    {'ESA --> PIC Chassis --> CH10: 3LION-2B'; 'AB01:BCS:2:3LION2BY'; '1'} ...
    };

for i = 1:length(bcs_items)
    val = lcaGetSmart(bcs_items{i}{2});
    expected_val = bcs_items{i}{3};
    if ~strcmpi(val, expected_val)
        problem_found = 1;
        fprintf('Problem found in %s\n', bcs_items{i}{1});
    end
end

disp('ESA checks complete.');
if ~problem_found, disp('No problems found!'), end

end